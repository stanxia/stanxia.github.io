<!DOCTYPE html>
<html>
    <head>
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.2.6 -->

    <!-- Title -->
    
    <title>
        
            EasyHadoop集群部署入门 | 
        
        小世界，大梦想
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="http://wx2.sinaimg.cn/mw690/6aae3cf3gy1fezankr4hxj203k03kmx3.jpg">
    <link rel="icon" sizes="192x192" href="http://wx2.sinaimg.cn/mw1024/6aae3cf3gy1fcur6pcgo6j20lf0f2175.jpg">
    <link rel="apple-touch-icon" href="http://wx2.sinaimg.cn/mw1024/6aae3cf3gy1fcur6pcgo6j20lf0f2175.jpg">

    <!-- Meta & Info -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="夏">
    <meta name="description" content="随便说说">
    <meta name="keywords" content="hive,hadoop,spark,hbase,hdfs,mapreduce,cluster">

    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="小世界，大梦想">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://stanxia.github.io">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="EasyHadoop集群部署入门 | 小世界，大梦想">
    <meta property="og:description" content="随便说说">

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->


<!-- Other Styles -->
<style>
    body, html {
        font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    }

    a {
        color: #00838F;
    }

    .mdl-card__media,
    #search-label,
    #search-form-label:after,
    #scheme-Paradox .hot_tags-count,
    #scheme-Paradox .sidebar_archives-count,
    #scheme-Paradox .sidebar-colored .sidebar-header,
    #scheme-Paradox .sidebar-colored .sidebar-badge{
        background-color: #0097A7 !important;
    }

    /* Sidebar User Drop Down Menu Text Color */
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
        color: #0097A7 !important;
    }

    #post_entry-right-info,
    .sidebar-colored .sidebar-nav li:hover > a,
    .sidebar-colored .sidebar-nav li:hover > a i,
    .sidebar-colored .sidebar-nav li > a:hover,
    .sidebar-colored .sidebar-nav li > a:hover i,
    .sidebar-colored .sidebar-nav li > a:focus i,
    .sidebar-colored .sidebar-nav > .open > a,
    .sidebar-colored .sidebar-nav > .open > a:hover,
    .sidebar-colored .sidebar-nav > .open > a:focus,
    #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
        color: #0097A7 !important;
    }

    .toTop {
        background: #757575 !important;
    }

    .material-layout .material-post>.material-nav,
    .material-layout .material-index>.material-nav,
    .material-nav a {
        color: #757575;
    }

    #scheme-Paradox .MD-burger-layer {
        background-color: #757575;
    }

    #scheme-Paradox #post-toc-trigger-btn {
        color: #757575;
    }

    .post-toc a:hover {
        color: #00838F;
        text-decoration: underline;
    }
</style>


<!-- Theme Background Related-->

    <style>
        body{
            background-color: #F5F5F5;
        }

        /* blog_info bottom background */
        #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
            background-color: #fff;
        }
    </style>




<!-- Fade Effect -->

    <style>
        .fade {
            transition: all 800ms linear;
            -webkit-transform: translate3d(0,0,0);
            -moz-transform: translate3d(0,0,0);
            -ms-transform: translate3d(0,0,0);
            -o-transform: translate3d(0,0,0);
            transform: translate3d(0,0,0);
            opacity: 1;
        }

        .fade.out{
            opacity: 0;
        }
    </style>


    <script src="/js/jquery.min.js"></script>

    <link rel="stylesheet" href="/css/highlight/solarized-white.css">

    <!-- UC Browser Compatible-->
    <script>
        var agent = navigator.userAgent.toLowerCase();
        if(agent.indexOf('ucbrowser')>0) {
            document.write('<link rel="stylesheet" href="/css/uc.css">');
            alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
        }
    </script>

    <!-- Custom Head -->
    
</head>


    
        <body id="scheme-Paradox">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#EasyHadoop-让你的Hadoop应用飞起来"><span class="post-toc-number">1.</span> <span class="post-toc-text">EasyHadoop 让你的Hadoop应用飞起来!</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#"><span class="post-toc-number">2.</span> <span class="post-toc-text"></span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#EasyHadoop集群部署入门"><span class="post-toc-number">3.</span> <span class="post-toc-text">EasyHadoop集群部署入门</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-文档概述"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">1.  文档概述</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-背景"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">2.  背景</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-名词解释"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">3.  名词解释</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#4-服务器结构"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">4.  服务器结构</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Hadoop试验集群的部署结构"><span class="post-toc-number">3.4.1.</span> <span class="post-toc-text">#Hadoop试验集群的部署结构</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#-1"><span class="post-toc-number">3.4.2.</span> <span class="post-toc-text"></span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#系统和组建的依赖关系"><span class="post-toc-number">3.4.3.</span> <span class="post-toc-text">#系统和组建的依赖关系</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#生产环境的部署结构"><span class="post-toc-number">3.4.4.</span> <span class="post-toc-text">#生产环境的部署结构</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#5-Red-hat-Linux基础环境搭建"><span class="post-toc-number">3.5.</span> <span class="post-toc-text">5.  Red hat Linux基础环境搭建</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#linux-安装-vm虚拟机"><span class="post-toc-number">3.5.1.</span> <span class="post-toc-text">#linux 安装 (vm虚拟机)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#配置机器时间同步"><span class="post-toc-number">3.5.2.</span> <span class="post-toc-text">#配置机器时间同步</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#配置机器网络环境"><span class="post-toc-number">3.5.3.</span> <span class="post-toc-text">#配置机器网络环境</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#配置集群hosts列表"><span class="post-toc-number">3.5.4.</span> <span class="post-toc-text">#配置集群hosts列表</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#下载并安装-JAVA-JDK系统软件"><span class="post-toc-number">3.5.5.</span> <span class="post-toc-text">#下载并安装 JAVA JDK系统软件</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#生成登陆密钥"><span class="post-toc-number">3.5.6.</span> <span class="post-toc-text">#生成登陆密钥</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#创建用户账号和Hadoop部署目录和数据目录"><span class="post-toc-number">3.5.7.</span> <span class="post-toc-text">#创建用户账号和Hadoop部署目录和数据目录</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#检查基础环境"><span class="post-toc-number">3.5.8.</span> <span class="post-toc-text">#检查基础环境</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#6-Hadoop-单机系统-安装配置"><span class="post-toc-number">3.6.</span> <span class="post-toc-text">6.  Hadoop 单机系统 安装配置</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Hadoop-文件下载和解压"><span class="post-toc-number">3.6.1.</span> <span class="post-toc-text">#Hadoop 文件下载和解压</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#配置-hadoop-env-sh-环境变量"><span class="post-toc-number">3.6.2.</span> <span class="post-toc-text">#配置 hadoop-env.sh 环境变量</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Hadoop-Common组件-配置-core-site-xml"><span class="post-toc-number">3.6.3.</span> <span class="post-toc-text">#Hadoop Common组件 配置 core-site.xml</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#HDFS-NameNode-DataNode组建配置hdfs-site-xml"><span class="post-toc-number">3.6.4.</span> <span class="post-toc-text">#HDFS NameNode,DataNode组建配置hdfs-site.xml</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#配置MapReduce-JobTrackerTaskTracker-启动配置"><span class="post-toc-number">3.6.5.</span> <span class="post-toc-text">#配置MapReduce - JobTrackerTaskTracker 启动配置</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Hadoop单机系统-启动执行和异常检查"><span class="post-toc-number">3.6.6.</span> <span class="post-toc-text">#Hadoop单机系统,启动执行和异常检查</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#通过界面查看集群部署部署成功"><span class="post-toc-number">3.6.7.</span> <span class="post-toc-text">#通过界面查看集群部署部署成功</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#通过执行-Hadoop-pi-运行样例检查集群是否成功"><span class="post-toc-number">3.6.8.</span> <span class="post-toc-text">#通过执行 Hadoop pi 运行样例检查集群是否成功</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#安装调试方法"><span class="post-toc-number">3.6.9.</span> <span class="post-toc-text">#安装调试方法</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#安装部署-常见错误"><span class="post-toc-number">3.6.10.</span> <span class="post-toc-text">#安装部署 常见错误</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#7-Hadoop-集群系统-配置安装配置"><span class="post-toc-number">3.7.</span> <span class="post-toc-text">7.  Hadoop 集群系统 配置安装配置</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#检查node节点linux-基础环境是否正常-参考-linux-基础环境搭建-一节。"><span class="post-toc-number">3.7.1.</span> <span class="post-toc-text">#检查node节点linux 基础环境是否正常,参考 [ linux 基础环境搭建]一节。</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#配置从master-机器到-node-节点无密钥登陆"><span class="post-toc-number">3.7.2.</span> <span class="post-toc-text">#配置从master 机器到 node 节点无密钥登陆</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#检查master到每个node节点在hadoop用户下使用密钥登陆是否正常"><span class="post-toc-number">3.7.3.</span> <span class="post-toc-text">#检查master到每个node节点在hadoop用户下使用密钥登陆是否正常</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#配置master-集群服务器地址stop-all-sh-start-all-sh-的时候调用"><span class="post-toc-number">3.7.4.</span> <span class="post-toc-text">#配置master 集群服务器地址stop-all.sh start-all.sh 的时候调用</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#通过界面查看集群部署部署成功-1"><span class="post-toc-number">3.7.5.</span> <span class="post-toc-text">#通过界面查看集群部署部署成功</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#通过执行-Hadoop-pi-运行样例检查集群是否成功-1"><span class="post-toc-number">3.7.6.</span> <span class="post-toc-text">#通过执行 Hadoop pi 运行样例检查集群是否成功</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#8-自动化安装脚本"><span class="post-toc-number">3.8.</span> <span class="post-toc-text">8.  自动化安装脚本</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#master-服务器自动安装脚本"><span class="post-toc-number">3.8.1.</span> <span class="post-toc-text">#master 服务器自动安装脚本</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#9-开启集群LZO"><span class="post-toc-number">3.9.</span> <span class="post-toc-text">9.  开启集群LZO</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#下载相关-LZO-包"><span class="post-toc-number">3.9.1.</span> <span class="post-toc-text">#下载相关 LZO 包</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#安装-LZO-相关包"><span class="post-toc-number">3.9.2.</span> <span class="post-toc-text">#安装 LZO 相关包</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#编译-安装-lzo-包"><span class="post-toc-number">3.9.3.</span> <span class="post-toc-text">#编译 安装 lzo 包</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#修改hadoop配置文件core-site-xml"><span class="post-toc-number">3.9.4.</span> <span class="post-toc-text">#修改hadoop配置文件core-site.xml</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#修改hadoop配置文件mapred-site-xml"><span class="post-toc-number">3.9.5.</span> <span class="post-toc-text">#修改hadoop配置文件mapred-site.xml</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#10-开启任务调度器"><span class="post-toc-number">3.10.</span> <span class="post-toc-text">10.          开启任务调度器</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#修改-mapred-site-xml"><span class="post-toc-number">3.10.1.</span> <span class="post-toc-text">#修改 mapred-site.xml</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#修改-capacity-scheduler-xml添加-hive-streaming-等队列。"><span class="post-toc-number">3.10.2.</span> <span class="post-toc-text">#修改 capacity-scheduler.xml添加 hive streaming 等队列。</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#11-开启机架感知"><span class="post-toc-number">3.11.</span> <span class="post-toc-text">11.          开启机架感知</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#修改hadoop配置文件core-site-xml-添加机架感知代码"><span class="post-toc-number">3.11.1.</span> <span class="post-toc-text">#修改hadoop配置文件core-site.xml 添加机架感知代码</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#新建-RackAware-py-文件"><span class="post-toc-number">3.11.2.</span> <span class="post-toc-text">#新建 RackAware.py 文件</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#12-配置详解"><span class="post-toc-number">3.12.</span> <span class="post-toc-text">12.          配置详解</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Hadoop系统配置详解"><span class="post-toc-number">3.12.1.</span> <span class="post-toc-text">#Hadoop系统配置详解</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#机器配置推荐"><span class="post-toc-number">3.12.2.</span> <span class="post-toc-text">#机器配置推荐</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#EasyHive仓库集群部署入门"><span class="post-toc-number">4.</span> <span class="post-toc-text">EasyHive仓库集群部署入门</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-名词解释"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">1.  名词解释</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-Hive的作用和原理说明"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">2.  Hive的作用和原理说明</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Hadoop仓库和传统数据仓库的协作结构图"><span class="post-toc-number">4.2.1.</span> <span class="post-toc-text">#Hadoop仓库和传统数据仓库的协作结构图</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Hadoop-Hive仓库数据日志分析流向图"><span class="post-toc-number">4.2.2.</span> <span class="post-toc-text">#Hadoop/Hive仓库数据日志分析流向图</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#hive内部结构图"><span class="post-toc-number">4.2.3.</span> <span class="post-toc-text">#hive内部结构图</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-Hive-部署和安装"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">3.  Hive 部署和安装</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#安装Hadoop集群-看EasyHadoop集群部署入门章节。"><span class="post-toc-number">4.3.1.</span> <span class="post-toc-text"> #安装Hadoop集群,看EasyHadoop集群部署入门章节。</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#编译安装Mysql-启动Mysql-检查gc-包。"><span class="post-toc-number">4.3.2.</span> <span class="post-toc-text">#编译安装Mysql,启动Mysql,检查gc++包。</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#登陆Mysql-服务器"><span class="post-toc-number">4.3.3.</span> <span class="post-toc-text">#登陆Mysql 服务器</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#添加Hive用户名和密码"><span class="post-toc-number">4.3.4.</span> <span class="post-toc-text">#添加Hive用户名和密码</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#解压Hive包并配置JDBC连接地址。"><span class="post-toc-number">4.3.5.</span> <span class="post-toc-text">#解压Hive包并配置JDBC连接地址。</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#编辑配置Hive默认文件"><span class="post-toc-number">4.3.5.1.</span> <span class="post-toc-text">#编辑配置Hive默认文件</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#修改一下hive-site-mysql-JDBC节点内容"><span class="post-toc-number">4.3.5.2.</span> <span class="post-toc-text">#修改一下hive-site mysql JDBC节点内容</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#添加Mysql-Hive用户名和密码-创建Hive-仓库"><span class="post-toc-number">4.3.6.</span> <span class="post-toc-text"> #添加Mysql Hive用户名和密码,创建Hive 仓库</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#登陆mysql-服务器"><span class="post-toc-number">4.3.6.1.</span> <span class="post-toc-text">#登陆mysql 服务器</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#启动Hive-thrift-Server"><span class="post-toc-number">4.3.7.</span> <span class="post-toc-text">#启动Hive thrift Server</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#启动hive-server"><span class="post-toc-number">4.3.7.1.</span> <span class="post-toc-text">#启动hive server</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#测试"><span class="post-toc-number">4.3.7.2.</span> <span class="post-toc-text">#测试</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#启动内置的Hive-UI。"><span class="post-toc-number">4.3.8.</span> <span class="post-toc-text">#启动内置的Hive UI。</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#4-Hive-Cli-的基本用法"><span class="post-toc-number">4.4.</span> <span class="post-toc-text">4.  Hive Cli 的基本用法</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#登陆查询"><span class="post-toc-number">4.4.1.</span> <span class="post-toc-text">#登陆查询</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#查询文件方式"><span class="post-toc-number">4.4.2.</span> <span class="post-toc-text">#查询文件方式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#编辑一个HQL-文件"><span class="post-toc-number">4.4.2.1.</span> <span class="post-toc-text">#编辑一个HQL 文件</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#读取查询文件查询方式"><span class="post-toc-number">4.4.2.2.</span> <span class="post-toc-text">#读取查询文件查询方式</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#命令行模式"><span class="post-toc-number">4.4.3.</span> <span class="post-toc-text">#命令行模式</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#5-HQL基本语法-创建表-加载表-分析查询-删除表"><span class="post-toc-number">4.5.</span> <span class="post-toc-text">5.  HQL基本语法 (创建表,加载表,分析查询,删除表)</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#快速案例"><span class="post-toc-number">4.5.1.</span> <span class="post-toc-text">#快速案例</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#创建表"><span class="post-toc-number">4.5.2.</span> <span class="post-toc-text">#创建表</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#加载数据"><span class="post-toc-number">4.5.3.</span> <span class="post-toc-text">#加载数据</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#分析查询"><span class="post-toc-number">4.5.4.</span> <span class="post-toc-text">#分析查询</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#6-使用hive到Mysql构建简单数据集市"><span class="post-toc-number">4.6.</span> <span class="post-toc-text">6.  使用hive到Mysql构建简单数据集市</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#创建一个数据表使用Hivecli-进行数据分析"><span class="post-toc-number">4.6.1.</span> <span class="post-toc-text">#创建一个数据表使用Hivecli 进行数据分析</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#使用shell-编写Hsql-并使用HiveCli导出数据-使用Mysql命令加载到数据库中。"><span class="post-toc-number">4.6.2.</span> <span class="post-toc-text">#使用shell 编写Hsql 并使用HiveCli导出数据,使用Mysql命令加载到数据库中。</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#使用crontab-新增每日运行任务定时器"><span class="post-toc-number">4.6.3.</span> <span class="post-toc-text">#使用crontab 新增每日运行任务定时器</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#7-使用FineReport-数据展现数据"><span class="post-toc-number">4.7.</span> <span class="post-toc-text">7.  使用FineReport 数据展现数据</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#安装FineReport-使用注册码"><span class="post-toc-number">4.7.1.</span> <span class="post-toc-text">#安装FineReport,使用注册码</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#使用FineReport-快速展现数据报表"><span class="post-toc-number">4.7.2.</span> <span class="post-toc-text">#使用FineReport,快速展现数据报表</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#8-练习"><span class="post-toc-number">4.8.</span> <span class="post-toc-text">8.  练习</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#EasyPig数据流分析集群部署入门"><span class="post-toc-number">5.</span> <span class="post-toc-text">EasyPig数据流分析集群部署入门</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-数据测试"><span class="post-toc-number">5.0.1.</span> <span class="post-toc-text">1.数据测试</span></a></li></ol></li></ol></li></ol>

        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        <!-- Custom Thumbnail -->
        <div class="post_thumbnail-custom mdl-card__media mdl-color-text--grey-50" style="background-image:url(http://wx2.sinaimg.cn/mw1024/6aae3cf3gy1fdlo2zqjn3j20k00a0jte.jpg)">
    
            <p class="article-headline-p">
                EasyHadoop集群部署入门
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>夏</strong>
        <span>3月 21, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
            <i class="material-icons" role="presentation">devices other</i>
            <span class="visuallyhidden">devices other</span>
        </button>
        <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
            <li class="mdl-menu__item">在其它设备中阅读本文章</li>
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAAC1ElEQVR42u3aQZLbMAwEQP//08kDNlbNAE4iU63T1pZNsenDFAC+fj3yeWFjY2NjY2NjY2Pfkv2Kn/zzP9d/992fn3m76XIPf9gJNjY29tHs9pX7Fa63+O6Hmb0RGxsb+znsJGDySLs+puvAyw+6eC82NjY29uXm2iJhVvxgY2NjY/+NAMvLg+sVknICGxsbG3vfVNr8Jy85ku/+014aNjY29u3ZbWFwh7//w3wbGxsb+5bsTz37pk8bY/UOsbGxsQ9lb1r8e1hSnOyHvtjY2Nhns/PYaHnJaCG/vnM9VIj2j42NjX00Oy8nkoPI46cNquSN0XgAGxsb+yB23WSPL9xsYi95VzIwwMbGxn4Cu936rMzYjATa1lKd29jY2NgHsZPyY9ZI2jeb9oGKjY2NfSo7H+LmBcw+imZrfqACw8bGxv5adl54tOXEJsDyYiNaARsbG/todlsG7Bv97d/7EggbGxv7aey8kTS7TJNfD0o+uWoqYWNjY385e/+ynJG0rto1kzDDxsbGPpudR0Ky3faiT349qB1IY2NjY2MXzZq4jMkDbBaEdQWGjY2NfRA7bwzNmlDt+p8aCWBjY2M/gZ2Q8tBqA6YdLayu+GBjY2Mfyp7FSdvoz0ezsxFCdBDY2NjYD2AnAZZHVF4ktMPm4Q+GjY2NfTR7NmrdbyUPp+RSznAqgo2NjX0EexZFSdS1Taj8mOrxBjY2NvbR7E1ZMitC8iHEZoSAjY2NjZ2E3GaE8NnBQH1TCRsbG/sIdvskR5Af3Gxs0AYhNjY29tns2VWY/VWe9jjyAfDqyg42Njb217KTCGnHA596ZuNebGxs7GeykzhpS5E8/GZXefKDxsbGxsbewPKhbH6seehiY2NjY8+CKh8G5yVQG37Y2NjYT2PnYZAfRwtIypLZgWJjY2Ofzd4PepNxQnusNew6RLGxsbEPZT/nwcbGxsbGxsbGxr7N8xu5+VMluIhT3AAAAABJRU5ErkJggg==">
        </ul>
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/hadoop/">hadoop</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    
    <!-- Leancloud Views -->
        <a class="post_share-link" href="#">
            <li class="mdl-menu__item">
                <span id="/2017/03/21/EasyHadoop集群部署入门/" class="leancloud-views_num" data-flag-title="EasyHadoop集群部署入门">
     &nbsp;浏览量
</span>

            </li>
        </a>
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=EasyHadoop集群部署入门&url=https://stanxia.github.io//2017/03/21/EasyHadoop集群部署入门/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=EasyHadoop集群部署入门&url=https://stanxia.github.io//2017/03/21/EasyHadoop集群部署入门/index.html&via=夏" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://stanxia.github.io//2017/03/21/EasyHadoop集群部署入门/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=https://stanxia.github.io//2017/03/21/EasyHadoop集群部署入门/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=小世界，大梦想&title=EasyHadoop集群部署入门&summary=随便说说&pics=https://stanxia.github.iohttp://wx2.sinaimg.cn/mw690/6aae3cf3gy1fezankr4hxj203k03kmx3.jpg&url=https://stanxia.github.io/2017/03/21/EasyHadoop集群部署入门/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="markdown-Github mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <script src="/assets/js/DPlayer.min.js"> </script><table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<h1 id="EasyHadoop-让你的Hadoop应用飞起来"><a href="#EasyHadoop-让你的Hadoop应用飞起来" class="headerlink" title="EasyHadoop 让你的Hadoop应用飞起来!"></a>EasyHadoop 让你的Hadoop应用飞起来!</h1><h1 id=""><a href="#" class="headerlink" title=""></a><img src="file://localhost/Users/xialinsheng/Library/Group%20Containers/UBF8T346G9.Office/msoclip1/01/clip_image004.png" alt="img"></h1><h1 id="EasyHadoop集群部署入门"><a href="#EasyHadoop集群部署入门" class="headerlink" title="EasyHadoop集群部署入门"></a><a href="undefined">EasyHadoop</a>集群部署入门</h1><p><a href="undefined">目录</a></p>
<p><a href="#_Toc17781">EasyHadoop集群部署入门文档……………………………………………………………………………………………………………………………………………………………………….. 2</a></p>
<p><a href="#_Toc20988">目录……………………………………………………………………………………………………………………………………………………………………………………………………………………….. 2</a></p>
<p><a href="#_Toc4660">1. 文档概述……………………………………………………………………………………………………………………………………………………………………………………………….. 3</a></p>
<p><a href="#_Toc2456">2. 背景………………………………………………………………………………………………………………………………………………………………………………………………………… 3</a></p>
<p><a href="#_Toc32501">3. 名词解释……………………………………………………………………………………………………………………………………………………………………………………………….. 4</a></p>
<p><a href="#_Toc16693">4. 服务器结构…………………………………………………………………………………………………………………………………………………………………………………………… 4</a></p>
<p><a href="#_Toc13472">#Hadoop试验集群的部署结构……………………………………………………………………………………………………………………………………………………… 4</a></p>
<p><a href="#_Toc2122">#系统和组建的依赖关系……………………………………………………………………………………………………………………………………………………………….. 5</a></p>
<p><a href="#_Toc11834">#生产环境的部署结构……………………………………………………………………………………………………………………………………………………………………. 6</a></p>
<p><a href="#_Toc6542">5. Red hat Linux基础环境搭建…………………………………………………………………………………………………………………………………………………………………. 6</a></p>
<p><a href="#_Toc16475">#linux 安装 (vm虚拟机)………………………………………………………………………………………………………………………………………………………………… 6</a></p>
<p><a href="#_Toc20745">#配置机器时间同步………………………………………………………………………………………………………………………………………………………………………… 6</a></p>
<p><a href="#_Toc4466">#配置机器网络环境………………………………………………………………………………………………………………………………………………………………………… 7</a></p>
<p><a href="#_Toc13264">#配置集群hosts列表…………………………………………………………………………………………………………………………………………………………………….. 10</a></p>
<p><a href="#_Toc12566">#下载并安装 JAVA JDK系统软件……………………………………………………………………………………………………………………………………………….. 10</a></p>
<p><a href="#_Toc7823">#生成登陆密钥………………………………………………………………………………………………………………………………………………………………………………. 11</a></p>
<p><a href="#_Toc12023">#创建用户账号和Hadoop部署目录和数据目录…………………………………………………………………………………………………………………… 11</a></p>
<p><a href="#_Toc6460">#检查基础环境………………………………………………………………………………………………………………………………………………………………………………. 12</a></p>
<p><a href="#_Toc22052">6. Hadoop 单机系统 安装配置…………………………………………………………………………………………………………………………………………………………… 13</a></p>
<p><a href="#_Toc440">#Hadoop 文件下载和解压…………………………………………………………………………………………………………………………………………………………… 13</a></p>
<p><a href="#_Toc6086">#配置 hadoop-env.sh 环境变量………………………………………………………………………………………………………………………………………………….. 13</a></p>
<p><a href="#_Toc3113">#Hadoop Common组件 配置core-site.xml………………………………………………………………………………………………………………………………… 13</a></p>
<p><a href="#_Toc18568">#HDFS NameNode,DataNode组建配置hdfs-site.xml…………………………………………………………………………………………………………………… 14</a></p>
<p><a href="#_Toc20292">#配置MapReduce - JobTracker TaskTracker 启动配置………………………………………………………………………………………………………………… 15</a></p>
<p><a href="#_Toc11828">#Hadoop单机系统,启动执行和异常检查………………………………………………………………………………………………………………………………… 17</a></p>
<p><a href="#_Toc1006">#通过界面查看集群部署部署成功…………………………………………………………………………………………………………………………………………… 18</a></p>
<p><a href="#_Toc1875">#通过执行 Hadoop pi 运行样例检查集群是否成功…………………………………………………………………………………………………………….. 19</a></p>
<p><a href="#_Toc6872">#安装部署 常见错误……………………………………………………………………………………………………………………………………………………………………. 20</a></p>
<p><a href="#_Toc17628">7. Hadoop 集群系统 配置安装配置………………………………………………………………………………………………………………………………………………….. 20</a></p>
<p><a href="#_Toc8194">#检查node节点linux 基础环境是否正常,参考 [ linux 基础环境搭建]一节。…………………………………………………………….. 20</a></p>
<p><a href="#_Toc11821">#配置从master 机器到 node 节点无密钥登陆…………………………………………………………………………………………………………………….. 20</a></p>
<p><a href="#_Toc25415">#检查master到每个node节点在hadoop用户下使用密钥登陆是否正常………………………………………………………………………. 21</a></p>
<p><a href="#_Toc10716">#配置master 集群服务器地址 stop-all.sh start-all.sh 的时候调用……………………………………………………………………………………….. 21</a></p>
<p><a href="#_Toc22114">#通过界面查看集群部署部署成功…………………………………………………………………………………………………………………………………………… 22</a></p>
<p><a href="#_Toc31281">#通过执行 Hadoop pi 运行样例检查集群是否成功…………………………………………………………………………………………………………….. 24</a></p>
<p><a href="#_Toc21520">8. 自动化安装脚本………………………………………………………………………………………………………………………………………………………………………………… 25</a></p>
<p><a href="#_Toc29249">#master 服务器自动安装脚本…………………………………………………………………………………………………………………………………………………….. 25</a></p>
<p><a href="#_Toc24883">Hive仓库集群部署入门文档…………………………………………………………………………………………………………………………………………………………………………. 27</a></p>
<p><a href="#_Toc4350">1. 名词解释……………………………………………………………………………………………………………………………………………………………………………………………… 27</a></p>
<p><a href="#_Toc16424">2. Hive的作用和原理说明…………………………………………………………………………………………………………………………………………………………………….. 27</a></p>
<p><a href="#_Toc6591">#数据仓库结构图………………………………………………………………………………………………………………………………………………………………………….. 27</a></p>
<p><a href="#_Toc12201">#Hive仓库流程图…………………………………………………………………………………………………………………………………………………………………………… 27</a></p>
<p><a href="#_Toc15882">#hive内部结构图……………………………………………………………………………………………………………………………………………………………………………. 27</a></p>
<p><a href="#_Toc14841">3. Hive 部署和安装…………………………………………………………………………………………………………………………………………………………………………………. 27</a></p>
<p><a href="#_Toc19110">#安装Hadoop集群,看EasyHadoop安装文档。……………………………………………………………………………………………………………………….. 27</a></p>
<p><a href="#_Toc24103">#安装Mysql,启动Mysql,检查gc++包。………………………………………………………………………………………………………………………………………. 27</a></p>
<p><a href="#_Toc6714">#解压Hive包并配置JDBC连接地址。……………………………………………………………………………………………………………………………………… 27</a></p>
<p><a href="#_Toc27818">#启动Hive thrift Server。………………………………………………………………………………………………………………………………………………………………… 27</a></p>
<p><a href="#_Toc25105">#启动内置的Hive UI。………………………………………………………………………………………………………………………………………………………………….. 27</a></p>
<p><a href="#_Toc31144">4. Hive Cli 的基本用法……………………………………………………………………………………………………………………………………………………………………………. 28</a></p>
<p><a href="#_Toc20912">#登陆查询……………………………………………………………………………………………………………………………………………………………………………………….. 28</a></p>
<p><a href="#_Toc6817">#查询文件方式………………………………………………………………………………………………………………………………………………………………………………. 28</a></p>
<p><a href="#_Toc1120">#命令行模式…………………………………………………………………………………………………………………………………………………………………………………… 28</a></p>
<p><a href="#_Toc4701">5. HQL基本语法 (创建表,加载表,分析查询,删除表)……………………………………………………………………………………………………………………… 28</a></p>
<p><a href="#_Toc31717">#创建表……………………………………………………………………………………………………………………………………………………………………………………………. 28</a></p>
<p><a href="#_Toc25926">6. 使用Mysql构建简单数据集市……………………………………………………………………………………………………………………………………………………….. 29</a></p>
<p><a href="#_Toc21993">#Mysql的两种引擎介绍……………………………………………………………………………………………………………………………………………………………….. 29</a></p>
<p><a href="#_Toc24983">#创建一个数据表使用Hive cli 进行数据分析………………………………………………………………………………………………………………………… 29</a></p>
<p><a href="#_Toc14839">#使用shell 编写Hsql 并使用HiveCli导出数据,使用Mysql命令加载到数据库中。……………………………………………………… 29</a></p>
<p><a href="#_Toc16906">#使用crontab 新增每日运行任务定时器……………………………………………………………………………………………………………………………….. 29</a></p>
<p><a href="#_Toc11243">7. 使用FineReport 数据展现数据………………………………………………………………………………………………………………………………………………………. 29</a></p>
<p><a href="#_Toc1768">#安装FineReport,使用注册码!……………………………………………………………………………………………………………………………………………………… 29</a></p>
<p><a href="#_Toc3908">#使用FineReport,快速展现数据报表。…………………………………………………………………………………………………………………………………….. 29</a></p>
<p><a href="#_Toc16553">#FineReport 的问题和局限…………………………………………………………………………………………………………………………………………………………… 29</a></p>
<h2 id="1-文档概述"><a href="#1-文档概述" class="headerlink" title="1.  文档概述"></a><a href="undefined">1.  文档概述</a></h2><p>本文档是Hadoop部署文档,提供了Hadoop单机安装和Hadoop集群安装的方法和步骤,本文档希望让Hadoop安装部署更简单(Easy)。</p>
<p>本安装文档适用于 centos 5 /red hat 5.2 32位,64位版本,ubuntu 等操作系统需要做部分修改。</p>
<h2 id="2-背景"><a href="#2-背景" class="headerlink" title="2.  背景"></a><a href="undefined">2.  背景</a></h2><p>Hadoop为分布式文件系统和计算的基础框架系统，其中包含hadoop程序，hdfs系统等。</p>
<h2 id="3-名词解释"><a href="#3-名词解释" class="headerlink" title="3.  名词解释"></a><a href="undefined">3.  名词解释</a></h2><p>1.Hadoop,  Apache开源的分布式框架。</p>
<p>2.HDFS,                  hadoop的分布式文件系统</p>
<p>3.NameNode,       hadoop HDFS元数据主节点服务器，负责保存DataNode 文件存储元数据信息。</p>
<p>4.JobTracker,        hadoop的Map/Reduce调度器，负责与TackTracker通信分配计算任务并跟踪任务进度。</p>
<p>5.DataNode,         hadoop数据节点，负责存储数据。</p>
<p>6.TaskTracker,       hadoop调度程序，负责Map,Reduce 任务的具体启动和执行。</p>
<p>7.Fuse,         多文件系统内核程序，可将不同的文件系统mount成linux可读写模式</p>
<h2 id="4-服务器结构"><a href="#4-服务器结构" class="headerlink" title="4.  服务器结构"></a><a href="undefined">4.  服务器结构</a></h2><h3 id="Hadoop试验集群的部署结构"><a href="#Hadoop试验集群的部署结构" class="headerlink" title="#Hadoop试验集群的部署结构"></a><a href="undefined">#Hadoop</a>试验集群的部署结构</h3><p>部署路径：/opt/modules/hadoop/hadoop-1.0.3/</p>
<p><img src="file://localhost/Users/xialinsheng/Library/Group%20Containers/UBF8T346G9.Office/msoclip1/01/clip_image006.png" alt="img"></p>
<h3 id="-1"><a href="#-1" class="headerlink" title=""></a><img src="file://localhost/Users/xialinsheng/Library/Group%20Containers/UBF8T346G9.Office/msoclip1/01/clip_image008.png" alt="img"></h3><h3 id="系统和组建的依赖关系"><a href="#系统和组建的依赖关系" class="headerlink" title="#系统和组建的依赖关系"></a><a href="undefined">#</a>系统和组建的依赖关系</h3><p><img src="/Users/xialinsheng/Desktop/微博图床图片/hadoop组建依赖.jpeg" alt="hadoop组建依赖">  </p>
<h3 id="生产环境的部署结构"><a href="#生产环境的部署结构" class="headerlink" title="#生产环境的部署结构"></a><a href="undefined">#</a>生产环境的部署结构</h3><p><img src="file://localhost/Users/xialinsheng/Library/Group%20Containers/UBF8T346G9.Office/msoclip1/01/clip_image010.png" alt="img"></p>
<h2 id="5-Red-hat-Linux基础环境搭建"><a href="#5-Red-hat-Linux基础环境搭建" class="headerlink" title="5.  Red hat Linux基础环境搭建"></a><a href="undefined">5.  Red hat Linux</a>基础环境搭建</h2><h3 id="linux-安装-vm虚拟机"><a href="#linux-安装-vm虚拟机" class="headerlink" title="#linux 安装 (vm虚拟机)"></a><a href="undefined">#linux </a>安装 (vm虚拟机)</h3><p>请参考其他 vmware 虚拟机安装文档。设置网络为 net 模式。</p>
<p>root hadoop </p>
<h3 id="配置机器时间同步"><a href="#配置机器时间同步" class="headerlink" title="#配置机器时间同步"></a><a href="undefined">#</a>配置机器时间同步</h3><p>#配置时间同步</p>
<p>crontab -e </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">0 1 * * * /usr/sbin/ntpdate cn.pool.ntp.org</div></pre></td></tr></table></figure>
<p>#手动同步时间</p>
<p>/usr/sbin/ntpdatecn.pool.ntp.org</p>
<h3 id="配置机器网络环境"><a href="#配置机器网络环境" class="headerlink" title="#配置机器网络环境"></a><a href="undefined">#</a>配置机器网络环境</h3><p>#修第一台 hostname 为 master </p>
<p>hostname master</p>
<p>#检测</p>
<p>hostname</p>
<p>   #配置主机名 (hostname)</p>
<p>   vi/etc/sysconfig/network </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">NETWORKING=yes <span class="comment">#启动网络</span></div><div class="line">NETWORKING_IPV6=no</div><div class="line">HOSTNAME=master  <span class="comment">#主机名</span></div></pre></td></tr></table></figure>
<p>#使用 setup 命令配置系统环境</p>
<p>setup </p>
<p>   <img src="file://localhost/Users/xialinsheng/Library/Group%20Containers/UBF8T346G9.Office/msoclip1/01/clip_image012.png" alt="img"></p>
<p>   <img src="file://localhost/Users/xialinsheng/Library/Group%20Containers/UBF8T346G9.Office/msoclip1/01/clip_image014.png" alt="img"> </p>
<pre><code>![img](file://localhost/Users/xialinsheng/Library/Group%20Containers/UBF8T346G9.Office/msoclip1/01/clip_image016.png)
</code></pre><p>   cat /etc/sysconfig/network-scripts/ifcfg-eth0  #检查ip配置 </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Advanced Micro Devices [AMD] 79c970 [PCnet32 LANCE]</span></div><div class="line">DEVICE=eth0</div><div class="line">BOOTPROTO=none</div><div class="line">HWADDR=00:0c:29:<span class="built_in">fc</span>:3a:09</div><div class="line">ONBOOT=yes</div><div class="line">NETMASK=255.255.255.0</div><div class="line">IPADDR=192.168.1.100</div><div class="line">TYPE=Ethernet</div></pre></td></tr></table></figure>
<p>/sbin/service network restart  #重新启动网络服务</p>
<p>/sbin/ifconfig  #检查网络ip配置</p>
<p>#关闭防火墙 如果不关闭 报错如下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">************************************************************/</div><div class="line">2012-07-18 02:47:26,331 INFO org.apache.hadoop.metrics2.impl.MetricsConfig: loaded properties from hadoop-metrics2.properties</div><div class="line">2012-07-18 02:47:26,529 INFO org.apache.hadoop.metrics2.impl.MetricsSourceAdapter: MBean for source MetricsSystem,sub=Stats registered.</div><div class="line">2012-07-18 02:47:26,533 ERROR org.apache.hadoop.metrics2.impl.MetricsSystemImpl: Error getting localhost name. Using &apos;localhost&apos;...</div><div class="line">java.net.UnknownHostException: node1: node1</div><div class="line">        at java.net.InetAddress.getLocalHost(InetAddress.java:1354)</div></pre></td></tr></table></figure>
<p><img src="file://localhost/Users/xialinsheng/Library/Group%20Containers/UBF8T346G9.Office/msoclip1/01/clip_image018.png" alt="img"></p>
<p>#关闭防火墙</p>
<p><img src="file://localhost/Users/xialinsheng/Library/Group%20Containers/UBF8T346G9.Office/msoclip1/01/clip_image020.png" alt="img"></p>
<h3 id="配置集群hosts列表"><a href="#配置集群hosts列表" class="headerlink" title="#配置集群hosts列表"></a><a href="undefined">#</a>配置集群hosts列表</h3><p>vi /etc/hosts</p>
<p>#添加一下内容到 vi 中</p>
<h3 id="下载并安装-JAVA-JDK系统软件"><a href="#下载并安装-JAVA-JDK系统软件" class="headerlink" title="#下载并安装 JAVA JDK系统软件"></a><a href="undefined">#</a>下载并安装 JAVA JDK系统软件</h3><p>#下载jdk </p>
<p>wget<a href="http://60.28.110.228/source/package/jdk-6u21-linux-i586-rpm.bin" target="_blank" rel="external">http://60.28.110.228/source/package/jdk-6u21-linux-i586-rpm.bin</a></p>
<p>#安装jdk</p>
<p>chmod +x jdk-6u21-linux-i586-rpm.bin</p>
<p>./jdk-6u21-linux-i586-rpm.bin</p>
<p>#配置环境变量</p>
<p>vi /etc/profile.d/java.sh</p>
<p>#复制粘贴一下内容 到 vi 中。</p>
<p>#手动立即生效</p>
<p>source /etc/profile</p>
<p>#测试 </p>
<p>jps</p>
<h3 id="生成登陆密钥"><a href="#生成登陆密钥" class="headerlink" title="#生成登陆密钥"></a><a href="undefined">#</a>生成登陆密钥</h3><p>#切换Hadoop 用户下</p>
<p>su hadoop </p>
<p>cd /home/hadoop/</p>
<p>#生成公钥和私钥</p>
<p>ssh-keygen -q -t rsa -N “” -f/home/hadoop/.ssh/id_rsa</p>
<p>cd .ssh</p>
<p>cat id_rsa.pub &gt; authorized_keys</p>
<p>chmod go-wx authorized_keys</p>
<p>#公钥:复制文件内容 id_rsa.pub到authorized_keys</p>
<p>#集群环境 id_ras_pub 复制到  node1:/home/hadoop/.ssh/authorized_keys</p>
<p>#检查 </p>
<p>ll -a /home/hadoop/.ssh/</p>
<h3 id="创建用户账号和Hadoop部署目录和数据目录"><a href="#创建用户账号和Hadoop部署目录和数据目录" class="headerlink" title="#创建用户账号和Hadoop部署目录和数据目录"></a><a href="undefined">#</a>创建用户账号和Hadoop部署目录和数据目录</h3><p>#创建 hadoop 用户</p>
<p>/usr/sbin/groupadd hadoop</p>
<p>#分配 hadoop 到 hadoop 组中</p>
<p>/usr/sbin/useradd hadoop -g hadoop</p>
<p>#创建 hadoop 代码目录结构</p>
<p>mkdir -p /opt/modules/hadoop/</p>
<p>#创建 hadoop 数据目录结构</p>
<p>mkdir -p /opt/data/hadoop/</p>
<p>#修改 目录结构权限为为hadoop</p>
<p>chown -R hadoop:hadoop  /opt/modules/hadoop/</p>
<p>chown -R hadoop:hadoop  /opt/data/hadoop/</p>
<h3 id="检查基础环境"><a href="#检查基础环境" class="headerlink" title="#检查基础环境"></a><a href="undefined">#</a>检查基础环境</h3><p>/sbin/ifconfig</p>
<p>#测试命令</p>
<p>/sbin/ifconfig</p>
<p>ping master</p>
<p>ssh master</p>
<p>jps</p>
<p>echo $JAVA_HOME</p>
<p>echo $HADOOP_HOME</p>
<p>hadoop</p>
<h2 id="6-Hadoop-单机系统-安装配置"><a href="#6-Hadoop-单机系统-安装配置" class="headerlink" title="6.  Hadoop 单机系统 安装配置"></a><a href="undefined">6.  Hadoop </a>单机系统 安装配置</h2><h3 id="Hadoop-文件下载和解压"><a href="#Hadoop-文件下载和解压" class="headerlink" title="#Hadoop 文件下载和解压"></a><a href="undefined">#Hadoop </a>文件下载和解压</h3><p>#切到 hadoop 安装路径下</p>
<p>cd /opt/modules/hadoop/</p>
<p>#从 hadoop.apache.org 下载Hadoop 安装文件</p>
<p>wget <a href="http://labs.renren.com/apache-mirror/hadoop/common/hadoop-1.0.3/hadoop-1.0.3.tar.gz" target="_blank" rel="external">http://labs.renren.com/apache-mirror/hadoop/common/hadoop-1.0.3/hadoop-1.0.3.tar.gz</a></p>
<p>#如果已经下载请复制文件到安装hadoop 文件夹</p>
<p>cp hadoop-1.0.3.tar.gz  /opt/modules/hadoop/</p>
<p>#加压 复制或者下载的Hadoop 文件</p>
<p>cd /opt/modules/hadoop/</p>
<p>tar -xzvf hadoop-1.0.3.tar.gz</p>
<p>hadoop </p>
<h3 id="配置-hadoop-env-sh-环境变量"><a href="#配置-hadoop-env-sh-环境变量" class="headerlink" title="#配置 hadoop-env.sh 环境变量"></a><a href="undefined">#</a>配置 hadoop-env.sh 环境变量</h3><p>#配置Hadoop 最大HADOOP_HEAPSIZE大小,  默认为 1000,因为虚拟机最大内存配置512m,这里配置较小。</p>
<p>#配置 压缩类库地址</p>
<p>vi/opt/modules/hadoop/hadoop-1.0.3/conf/hadoop-env.sh</p>
<h3 id="Hadoop-Common组件-配置-core-site-xml"><a href="#Hadoop-Common组件-配置-core-site-xml" class="headerlink" title="#Hadoop Common组件 配置 core-site.xml"></a><a href="undefined">#Hadoop Common</a>组件 配置 core-site.xml</h3><p>#编辑 core-site.xml 文件</p>
<p>vi /opt/modules/hadoop/hadoop-1.0.3/conf/core-site.xml</p>
<table>
<thead>
<tr>
<th><configuration>    <property>      <name>fs.default.name</name>  <value>hdfs://master:9000</value>  <!--hadoop namenode 服务器地址和端口，以域名形式-->    </property>    <property>      <name>fs.checkpoint.dir</name>       <value>/opt/data/hadoop/hdfs/namesecondary</value>      <!--hadoop secondary  数据存储路径,可以配置成多个目录,用,号分隔。-->    </property>    <property>       <name>fs.checkpoint.period</name>  <value>1800</value>  <!-- editlog 每隔 30分钟 触发一次合并 -->    </property>    <property>       <name>fs.checkpoint.size</name>  <value>33554432</value>  <!-- editlog 达到32m的时候触发一次合并 -->    </property>    <property>       <name>io.compression.codecs</name>  <value>org.apache.hadoop.io.compress.DefaultCodec,org.apache.hadoop.io.compress.GzipCodec,org.apache.hadoop.io.compress.BZip2Codec</value>  <!-- 配置 Hadoop 压缩包 -->    </property>       <property>       <name>fs.trash.interval</name>      <value>1440</value>      <description>Hadoop文件回收站,自动回收时间,单位分钟,这里设置是1天。</description>    </property>     </configuration></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<h3 id="HDFS-NameNode-DataNode组建配置hdfs-site-xml"><a href="#HDFS-NameNode-DataNode组建配置hdfs-site-xml" class="headerlink" title="#HDFS NameNode,DataNode组建配置hdfs-site.xml"></a><a href="undefined">#HDFS NameNode,DataNode</a>组建配置hdfs-site.xml</h3><p>vi /opt/modules/hadoop/hadoop-1.0.3/conf/hdfs-site.xml</p>
<h3 id="配置MapReduce-JobTrackerTaskTracker-启动配置"><a href="#配置MapReduce-JobTrackerTaskTracker-启动配置" class="headerlink" title="#配置MapReduce - JobTrackerTaskTracker 启动配置"></a><a href="undefined">#</a>配置MapReduce - JobTrackerTaskTracker 启动配置</h3><p>vi /opt/modules/hadoop/hadoop-1.0.3/conf/mapred-site.xml</p>
<h3 id="Hadoop单机系统-启动执行和异常检查"><a href="#Hadoop单机系统-启动执行和异常检查" class="headerlink" title="#Hadoop单机系统,启动执行和异常检查"></a><a href="undefined">#Hadoop</a>单机系统,启动执行和异常检查</h3><p>描述系统重启，启动，停止，升级，以及其他故障的处理方式</p>
<p>#创建Hadoop mapred 和 hdfs namenode 和 datanode 目录 在 root 下</p>
<p>mkdir -p/data/hadoop/</p>
<p>chown -Rhadoop:hadoop /data/*</p>
<p>#切换到 hadoop 用户下</p>
<p>su hadoop</p>
<p>#创建mapreduce </p>
<p>mkdir -p /opt/data/hadoop/mapred/mrlocal<br>mkdir -p /opt/data/hadoop/mapred/mrsystem</p>
<p>mkdir -p /opt/data/hadoop/hdfs/name</p>
<p>mkdir -p/opt/data/hadoop/hdfs/data</p>
<p>mkdir -p /opt/data/hadoop/hdfs/namesecondary</p>
<p>#启动 切换到hadoop用户</p>
<p>su hadoop</p>
<p>#格式化文件</p>
<p>/opt/modules/hadoop/hadoop-1.0.3/bin/hadoopnamenode -format</p>
<p>#启动 Master node ：</p>
<p>/opt/modules/hadoop/hadoop-1.0.3/bin/hadoop-daemon.shstart namenode</p>
<p>#启动 JobTracker：</p>
<p>/opt/modules/hadoop/hadoop-1.0.3/bin/hadoop-daemon.shstart jobtracker</p>
<p>#启动 secondarynamenode：</p>
<p>/opt/modules/hadoop/hadoop-1.0.3/bin/hadoop-daemon.shstart secondarynamenode</p>
<p>#启动 DataNode &amp;&amp; TaskTracker：</p>
<p>/opt/modules/hadoop/hadoop-1.0.3/bin/hadoop-daemon.shstart datanode</p>
<p>/opt/modules/hadoop/hadoop-1.0.3/bin/hadoop-daemon.shstart tasktracker</p>
<p>停止，命令相同，将start换为stop</p>
<p>#出现错误可查看日志</p>
<p>tail -f/opt/modules/hadoop/hadoop-1.0.3/logs/*</p>
<h3 id="通过界面查看集群部署部署成功"><a href="#通过界面查看集群部署部署成功" class="headerlink" title="#通过界面查看集群部署部署成功"></a><a href="undefined">#</a>通过界面查看集群部署部署成功</h3><p>#检查 namenode 和 datanode 是否正常</p>
<p><a href="http://localhost:50070/" target="_blank" rel="external">http://master:50070/</a></p>
<p><img src="file://localhost/Users/xialinsheng/Library/Group%20Containers/UBF8T346G9.Office/msoclip1/01/clip_image022.png" alt="img"></p>
<p>#检查 jobtracker 和 tasktracker 是否正常</p>
<p><a href="http://localhost:50030/" target="_blank" rel="external">http://master:50030/</a></p>
<p><img src="file://localhost/Users/xialinsheng/Library/Group%20Containers/UBF8T346G9.Office/msoclip1/01/clip_image024.png" alt="img"></p>
<h3 id="通过执行-Hadoop-pi-运行样例检查集群是否成功"><a href="#通过执行-Hadoop-pi-运行样例检查集群是否成功" class="headerlink" title="#通过执行 Hadoop pi 运行样例检查集群是否成功"></a><a href="undefined">#</a>通过执行 Hadoop pi 运行样例检查集群是否成功</h3><p>cd /opt/modules/hadoop/hadoop-1.0.3</p>
<p>bin/hadoop jar hadoop-examples-1.0.3.jar pi10 100</p>
<p>#集群正常效果如下</p>
<h3 id="安装调试方法"><a href="#安装调试方法" class="headerlink" title="#安装调试方法"></a><a href="undefined">#</a>安装调试方法</h3><p>#启动程序 namenodedatanode jobtracker tasktracker </p>
<p>hadoop-daemon.shstart xxxx</p>
<p>#检查进程是否存活<br>jps</p>
<p>#检查日志是否正常</p>
<p>tail-100f /opt/modules/hadoop/hadoop-1.0.3/libexec/../logs/hadoop-hadoop-xxxx-master.log</p>
<p>#检查端口是否正常</p>
<p><a href="http://master:50030" target="_blank" rel="external">http://master:50070</a></p>
<p><a href="http://master:50070" target="_blank" rel="external">http://master:50030</a></p>
<p>#检查 hdfs 是否正常</p>
<p>hadoopfs -ls /</p>
<p>hadoopfs -mkdir /data/</p>
<p>hadoopfs -put xxx.log /data/</p>
<p>#检查 mapreduce 是否正常</p>
<p>hadoopjar hadoop-examples-1.0.3.jar pi 100 100</p>
<h3 id="安装部署-常见错误"><a href="#安装部署-常见错误" class="headerlink" title="#安装部署 常见错误"></a>#安装部署 常见错误</h3><p>主机文件/etc/hosts中主机列表IP错误。mapred-site.xml中任务分配过多或过少，导致效率降低或内存溢出。物理硬盘的权限均应为hadoop:hadoop，执行启动也应su为hadoop用户。比较常见是出现权限错误导致无法启动故障。</p>
<p>如果遇到服务无法启动。请检查 $HADOOP_HOME/logs/ 目录具体日志情况。</p>
<p>tail -n 100 $HADOOP_HOME/logs/<em>namenode</em>  #检查namenode 服务日志</p>
<p>tail -n 100$HADOOP_HOME/logs/<em>datanode</em>   #检查datanode服务日志</p>
<p>Tail -n 100$HADOOP_HOME/logs/<em>jobtracker</em>   #检查jobtracker服务日志</p>
<h2 id="7-Hadoop-集群系统-配置安装配置"><a href="#7-Hadoop-集群系统-配置安装配置" class="headerlink" title="7.  Hadoop 集群系统 配置安装配置"></a><a href="undefined">7.  Hadoop </a>集群系统 配置安装配置</h2><h3 id="检查node节点linux-基础环境是否正常-参考-linux-基础环境搭建-一节。"><a href="#检查node节点linux-基础环境是否正常-参考-linux-基础环境搭建-一节。" class="headerlink" title="#检查node节点linux 基础环境是否正常,参考 [ linux 基础环境搭建]一节。"></a><a href="undefined">#</a>检查node节点linux 基础环境是否正常,参考 [ linux 基础环境搭建]一节。</h3><h3 id="配置从master-机器到-node-节点无密钥登陆"><a href="#配置从master-机器到-node-节点无密钥登陆" class="headerlink" title="#配置从master 机器到 node 节点无密钥登陆"></a><a href="undefined">#</a>配置从master 机器到 node 节点无密钥登陆</h3><p>#切换到Hadoop 用户下</p>
<p>su hadoop </p>
<p>cd /home/hadoop/</p>
<p>#生成公钥和私钥</p>
<p>ssh-keygen -q -t rsa -N “” -f/home/hadoop/.ssh/id_rsa</p>
<p>#查看密钥内容</p>
<p>cd /home/hadoop/.ssh</p>
<p>cat id_rsa.pub</p>
<p>#看到如下内容举例</p>
<p>#复制id_rsa.pub公钥到authorized_keys 目录</p>
<p>cat id_rsa.pub &gt; authorized_keys</p>
<p>#修改master 密钥权限,非常容易错误的地方。</p>
<p>chmod go-rwx /home/hadoop/.ssh/authorized_keys</p>
<p>#把 master 机器上的 authorized_keys文件 copy 到 node1 节点上。</p>
<p>scp /home/hadoop/.ssh/authorized_keys /home/hadoop/.ssh/</p>
<p>#输入 hadoop 密码</p>
<p>#修改 node1 密钥权限</p>
<p>chmod go-rwx /home/hadoop/.ssh/authorized_keys</p>
<p>#验证本机无密钥登陆,如果无需密码算成功。</p>
<p>ssh 192.168.1.100</p>
<p>exit #退出</p>
<p>ssh master</p>
<p>exit #退出</p>
<p>#验证登陆 192.168.1.101 ,如果无需密码算成功。</p>
<p>ssh 192.168.1.101</p>
<p>exit #退出</p>
<p>ssh node1</p>
<p>exit #退出</p>
<h3 id="检查master到每个node节点在hadoop用户下使用密钥登陆是否正常"><a href="#检查master到每个node节点在hadoop用户下使用密钥登陆是否正常" class="headerlink" title="#检查master到每个node节点在hadoop用户下使用密钥登陆是否正常"></a><a href="undefined">#</a>检查master到每个node节点在hadoop用户下使用密钥登陆是否正常</h3><p>su hadoop </p>
<p>#检查master 登陆master正常</p>
<p>ssh master</p>
<p>exit #退出</p>
<p>#检查 master 登陆node1 正常</p>
<p>ssh node1</p>
<p>exit #退出</p>
<h3 id="配置master-集群服务器地址stop-all-sh-start-all-sh-的时候调用"><a href="#配置master-集群服务器地址stop-all-sh-start-all-sh-的时候调用" class="headerlink" title="#配置master 集群服务器地址stop-all.sh start-all.sh 的时候调用"></a><a href="undefined">#</a>配置master 集群服务器地址stop-all.sh start-all.sh 的时候调用</h3><p>#设置 hadoop secondary node hostname批量启动的地址</p>
<p>#配置secondary的地址</p>
<p>vi /opt/modules/hadoop/hadoop-1.0.3/conf/masters</p>
<p>#配置 datanode 和 tasktracker 的地址</p>
<p>vi /opt/modules/hadoop/hadoop-1.0.3/conf/slaves</p>
<p>#复制 master hadoop到 node1 node2节点服务器上</p>
<p>#切换到 hadoop 用户下</p>
<p>su hadoop</p>
<p>scp -r /opt/modules/hadoop/hadoop-1.0.3/    node1:/opt/modules/hadoop/</p>
<p>#登陆到 node1 节点上</p>
<p>ssh node1 </p>
<p>#创建mapreduce</p>
<p>mkdir -p /data/hadoop/mapred/mrlocal<br>mkdir -p /data/hadoop/mapred/mrsystem</p>
<p>mkdir -p /data/hadoop/hdfs/name</p>
<p>mkdir -p /data/hadoop/hdfs/data</p>
<p>chmod go-w /data/hadoop/hdfs/data</p>
<p>#批量启动和关闭集群</p>
<p>#全部启动 </p>
<p>/opt/modules/hadoop/hadoop-1.0.3/bin/start-all.sh</p>
<p>#全部关闭</p>
<p>/opt/modules/hadoop/hadoop-1.0.3/bin/stop-all.sh</p>
<h3 id="通过界面查看集群部署部署成功-1"><a href="#通过界面查看集群部署部署成功-1" class="headerlink" title="#通过界面查看集群部署部署成功"></a><a href="undefined">#</a>通过界面查看集群部署部署成功</h3><p>#检查 namenode 和 datanode 是否正常</p>
<p><a href="http://localhost:50070/" target="_blank" rel="external">http://master:50070/</a></p>
<p><img src="file://localhost/Users/xialinsheng/Library/Group%20Containers/UBF8T346G9.Office/msoclip1/01/clip_image025.png" alt="img"></p>
<p>#检查 jobtracker 和 tasktracker 是否正常</p>
<p><a href="http://localhost:50030/" target="_blank" rel="external">http://master:50030/</a></p>
<p>hadoop fs -ls /</p>
<p>hadoop fs -mkdir/data/</p>
<p><img src="file://localhost/Users/xialinsheng/Library/Group%20Containers/UBF8T346G9.Office/msoclip1/01/clip_image026.png" alt="img"></p>
<h3 id="通过执行-Hadoop-pi-运行样例检查集群是否成功-1"><a href="#通过执行-Hadoop-pi-运行样例检查集群是否成功-1" class="headerlink" title="#通过执行 Hadoop pi 运行样例检查集群是否成功"></a><a href="undefined">#</a>通过执行 Hadoop pi 运行样例检查集群是否成功</h3><p>cd /opt/modules/hadoop/hadoop-1.0.3</p>
<p>bin/hadoop jar hadoop-examples-1.0.3.jar pi10 100</p>
<p>#集群正常效果如下</p>
<h2 id="8-自动化安装脚本"><a href="#8-自动化安装脚本" class="headerlink" title="8.  自动化安装脚本"></a><a href="undefined">8.  自动化安装脚本</a></h2><p>为加快服务器集群的安装和部署,会使用自动化安装脚本安装。以下为自动化部署脚本样例。脚本中#红色部分 具体参考以上配置做具体修改。本脚本里面的安装包用于 64位服务器安装,32位安装包需要单独下载修改。</p>
<h3 id="master-服务器自动安装脚本"><a href="#master-服务器自动安装脚本" class="headerlink" title="#master 服务器自动安装脚本"></a><a href="undefined">#master </a>服务器自动安装脚本</h3><p>#hadoop_install.sh,将以下放入shell脚本中并执行。</p>
<p>vi hadoop_install.sh</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line">#!/bin/sh</div><div class="line">yum -y install lrzsz gcc gcc-c++ libstdc++-devel ntp  #安装gcc 基础环境</div><div class="line">echo &quot;0 1 * * * root /usr/sbin/ntpdate cn.pool.ntp.org&quot; &gt;&gt; /etc/crontab  #配置时间同步</div><div class="line">/usr/sbin/ntpdate cn.pool.ntp.org #手动同步时间</div><div class="line">/usr/sbin/groupadd hadoop #新增hadoop 群组</div><div class="line">/usr/sbin/useradd hadoop -g hadoop #新增Hadoop 用户并绑定到hadoop 群中</div><div class="line"></div><div class="line">#安装依赖包并设置hadoop用户</div><div class="line">mkdir -p /opt/modules/hadoop/</div><div class="line">mkdir -p /opt/data/hadoop/</div><div class="line">chown hadoop:hadoop /opt/data/hadoop/</div><div class="line"></div><div class="line">#配置 /etc/hosts ip 对应主机名称</div><div class="line">echo -e &quot;127.0.0.1\tlocalhost.localdomain localhost</div><div class="line">#::1\tlocalhost6.localdomain6 localhost6</div><div class="line">#机架1</div><div class="line">192.168.1.100\thadoopmaster</div><div class="line">192.168.1.101\thadoopslave</div><div class="line">192.168.1.101\thadoop-node-101</div><div class="line">&quot; &gt; /etc/hosts</div><div class="line"></div><div class="line">#获取服务器外网IP并替换host中127.0.0.1 collect-*</div><div class="line">IP=`/sbin/ifconfig eth0 | grep &quot;inet addr&quot; | awk -F&quot;:&quot; &apos;&#123;print $2&#125;&apos; | awk -F&quot; &quot; &apos;&#123;print $1&#125;&apos;`</div><div class="line">sed -i &quot;s/^127.0.0.1\tcollect/$&#123;IP&#125;\tcollect/g&quot; /etc/hosts</div><div class="line"></div><div class="line">echo &quot;----------------env init finish and prepare su hadoop---------------&quot;</div><div class="line"></div><div class="line">HADOOP=/home/hadoop</div><div class="line"></div><div class="line">cd $HADOOP</div><div class="line"></div><div class="line">#生成密钥</div><div class="line">sudo -u hadoop mkdir .ssh</div><div class="line">ssh-keygen -q -t rsa -N &quot;&quot; -f $HADOOP/.ssh/id_rsa</div><div class="line">Cd$HADOOP/.ssh/ &amp;&amp; echo &quot;#此处需要 cat master id_rsa.pub&quot; &gt; $HADOOP/.ssh/authorized_keys</div><div class="line">chmod go-rwx $HADOOP/.ssh/authorized_keys #修改文件权限</div><div class="line">cd $HADOOP</div><div class="line"></div><div class="line">#下载已经配置好的 Hadoop 集群包</div><div class="line">wget http://60.28.110.228/source/package/hadoop/hadoop_gz.tar.gz</div><div class="line">wget http://60.28.110.228/source/package/hadoop/hadoop_rpm.tar.gz</div><div class="line"></div><div class="line">mkdir $HADOOP/hadoop</div><div class="line">mv *.tar.gz $HADOOP/hadoop</div><div class="line">cd $HADOOP/hadoop</div><div class="line">tar zxvf hadoop_rpm.tar.gz</div><div class="line">tar zxvf hadoop_gz.tar.gz</div><div class="line"></div><div class="line">rpm -ivh jdk-6u21-linux-amd64.rpm</div><div class="line">rpm -ivh lrzsz-0.12.20-19.x86_64.rpm</div><div class="line">rpm -ivh lzo-2.04-1.el5.rf.x86_64.rpm</div><div class="line">rpm -ivh hadoop-gpl-packaging-0.2.8-1.x86_64.rpm</div><div class="line"></div><div class="line">tar xzvf lzo-2.06.tar.gz</div><div class="line">cd lzo-2.06 &amp;&amp; ./configure --enable-shared &amp;&amp; make &amp;&amp; make install</div><div class="line">cp /usr/local/lib/liblzo2.* /usr/lib/</div><div class="line">cd ..</div><div class="line"></div><div class="line">tar xzvf  lzop-1.03.tar.gz</div><div class="line">cd lzop-1.03</div><div class="line">./configure &amp;&amp; make &amp;&amp; make install &amp;&amp; cd ..</div><div class="line"></div><div class="line">chown -R hadoop:hadoop  /opt/modules/hadoop/</div><div class="line"></div><div class="line">cp hadoop-node-0.20.203.0.tar.gz /opt/modules/hadoop/</div><div class="line">cd /opt/modules/hadoop/ &amp;&amp; tar -xzvf hadoop-node-0.20.203.0.tar.gz</div><div class="line"></div><div class="line">chown -R hadoop:hadoop /opt/modules/hadoop/</div><div class="line">chown -R hadoop:hadoop /home/hadoop</div></pre></td></tr></table></figure>
<h2 id="9-开启集群LZO"><a href="#9-开启集群LZO" class="headerlink" title="9.  开启集群LZO"></a>9.  开启集群LZO</h2><h3 id="下载相关-LZO-包"><a href="#下载相关-LZO-包" class="headerlink" title="#下载相关 LZO 包"></a>#下载相关 LZO 包</h3><p>wget <a href="http://113.11.199.230/resources/lzop-1.03.tar.gz" target="_blank" rel="external">http://113.11.199.230/resources/lzop-1.03.tar.gz</a></p>
<p>wget <a href="http://113.11.199.230/resources/x64/hadoop-gpl-packaging-0.5.3-1.x86_64.rpm" target="_blank" rel="external">http://113.11.199.230/resources/x64/hadoop-gpl-packaging-0.5.3-1.x86_64.rpm</a></p>
<p>wget <a href="http://113.11.199.230/resources/lzo-2.06.tar.gz" target="_blank" rel="external">http://113.11.199.230/resources/lzo-2.06.tar.gz</a></p>
<p>wget <a href="http://113.11.199.230/resources/x64/lzo-2.06-1.el5.rf.x86_64.rpm" target="_blank" rel="external">http://113.11.199.230/resources/x64/lzo-2.06-1.el5.rf.x86_64.rpm</a></p>
<p>wget <a href="http://113.11.199.230/resources/x64/lzo-devel-2.06-1.el5.rf.x86_64.rpm" target="_blank" rel="external">http://113.11.199.230/resources/x64/lzo-devel-2.06-1.el5.rf.x86_64.rpm</a></p>
<h3 id="安装-LZO-相关包"><a href="#安装-LZO-相关包" class="headerlink" title="#安装 LZO 相关包"></a>#安装 LZO 相关包</h3><p>rpm -ivhlzo-2.06-1.el5.rf.x86_64.rpm lzo-devel-2.06-1.el5.rf.x86_64.rpmhadoop-gpl-packaging-0.5.3-1.x86_64.rpm</p>
<h3 id="编译-安装-lzo-包"><a href="#编译-安装-lzo-包" class="headerlink" title="#编译 安装 lzo 包"></a>#编译 安装 lzo 包</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">tar zxf lzo-2.06.tar.gz</div><div class="line"></div><div class="line">cd lzo-2.06</div><div class="line"></div><div class="line">./configure &amp;&amp; make &amp;&amp; makeinstall</div><div class="line"></div><div class="line">cd ../</div><div class="line"></div><div class="line">tar zxf lzop-1.03.tar.gz</div><div class="line"></div><div class="line">cd lzop-1.03</div><div class="line"></div><div class="line">./configure &amp;&amp; make &amp;&amp; makeinstall</div></pre></td></tr></table></figure>
<h3 id="修改hadoop配置文件core-site-xml"><a href="#修改hadoop配置文件core-site-xml" class="headerlink" title="#修改hadoop配置文件core-site.xml"></a>#修改hadoop配置文件core-site.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>io.compression.codecs<span class="tag">&lt;/<span class="name">name</span>&gt;</span>      <span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.io.compress.GzipCodec,org.apache.hadoop.io.compress.DefaultCodec,com.hadoop.compression.lzo.LzoCodec,org.apache.hadoop.io.compress.BZip2Codec<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>io.compression.codec.lzo.class<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>com.hadoop.compression.lzo.LzoCodec<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="修改hadoop配置文件mapred-site-xml"><a href="#修改hadoop配置文件mapred-site-xml" class="headerlink" title="#修改hadoop配置文件mapred-site.xml"></a>#修改hadoop配置文件mapred-site.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.map.output.compression.codec<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>com.hadoop.compression.lzo.LzoCodec<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.child.java.opts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>-Djava.library.path=/opt/hadoopgpl/native/Linux-amd64-64:/opt/modules/hadoop/hadoop-1.0.3/lib/native/Linux-amd64-64<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="10-开启任务调度器"><a href="#10-开启任务调度器" class="headerlink" title="10.          开启任务调度器"></a>10.          开启任务调度器</h2><h3 id="修改-mapred-site-xml"><a href="#修改-mapred-site-xml" class="headerlink" title="#修改 mapred-site.xml"></a>#修改 mapred-site.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.jobtracker.taskScheduler<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.mapred.CapacityTaskScheduler<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.queue.names<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>default,hive,streaming<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="修改-capacity-scheduler-xml添加-hive-streaming-等队列。"><a href="#修改-capacity-scheduler-xml添加-hive-streaming-等队列。" class="headerlink" title="#修改 capacity-scheduler.xml添加 hive streaming 等队列。"></a>#修改 capacity-scheduler.xml添加 hive streaming 等队列。</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0"?&gt;  </div><div class="line">      </div><div class="line">    <span class="comment">&lt;!-- This is the configuration file for the resource manager in Hadoop. --&gt;</span>  </div><div class="line">    <span class="comment">&lt;!-- You can configure various scheduling parameters related to queues. --&gt;</span>  </div><div class="line">    <span class="comment">&lt;!-- The properties for a queue follow a naming convention,such as, --&gt;</span>  </div><div class="line">    <span class="comment">&lt;!-- mapred.capacity-scheduler.queue.&lt;queue-name&gt;.property-name. --&gt;</span>  </div><div class="line">      </div><div class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span>  </div><div class="line">      </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.maximum-system-jobs<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>3000<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Maximum number of jobs in the system which can be initialized,  </div><div class="line">         concurrently, by the CapacityScheduler.  </div><div class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span>      </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">        </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.default.capacity<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>10<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Percentage of the number of slots in the cluster that are  </div><div class="line">          to be available for jobs in this queue.  </div><div class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span>      </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">        </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.default.maximum-capacity<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>  </div><div class="line">        maximum-capacity defines a limit beyond which a queue cannot use the capacity of the cluster.  </div><div class="line">        This provides a means to limit how much excess capacity a queue can use. By default, there is no limit.  </div><div class="line">        The maximum-capacity of a queue can only be greater than or equal to its minimum capacity.  </div><div class="line">            Default value of -1 implies a queue can use complete capacity of the cluster.  </div><div class="line">      </div><div class="line">            This property could be to curtail certain jobs which are long running in nature from occupying more than a   </div><div class="line">            certain percentage of the cluster, which in the absence of pre-emption, could lead to capacity guarantees of   </div><div class="line">            other queues being affected.  </div><div class="line">              </div><div class="line">            One important thing to note is that maximum-capacity is a percentage , so based on the cluster's capacity  </div><div class="line">            the max capacity would change. So if large no of nodes or racks get added to the cluster , max Capacity in   </div><div class="line">            absolute terms would increase accordingly.  </div><div class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span>      </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">        </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.default.supports-priority<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>If true, priorities of jobs will be taken into   </div><div class="line">          account in scheduling decisions.  </div><div class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">      </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.default.minimum-user-limit-percent<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>100<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span> Each queue enforces a limit on the percentage of resources   </div><div class="line">        allocated to a user at any given time, if there is competition for them.   </div><div class="line">        This user limit can vary between a minimum and maximum value. The former  </div><div class="line">        depends on the number of users who have submitted jobs, and the latter is  </div><div class="line">        set to this property value. For example, suppose the value of this   </div><div class="line">        property is 25. If two users have submitted jobs to a queue, no single   </div><div class="line">        user can use more than 50% of the queue resources. If a third user submits  </div><div class="line">        a job, no single user can use more than 33% of the queue resources. With 4   </div><div class="line">        or more users, no user can use more than 25% of the queue's resources. A   </div><div class="line">        value of 100 implies no user limits are imposed.   </div><div class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">        </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.default.user-limit-factor<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>The multiple of the queue capacity which can be configured to   </div><div class="line">        allow a single user to acquire more slots.   </div><div class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">      </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.default.maximum-initialized-active-tasks<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>200000<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>The maximum number of tasks, across all jobs in the queue,   </div><div class="line">        which can be initialized concurrently. Once the queue's jobs exceed this   </div><div class="line">        limit they will be queued on disk.    </div><div class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">      </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.default.maximum-initialized-active-tasks-per-user<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>100000<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>The maximum number of tasks per-user, across all the of the   </div><div class="line">        user's jobs in the queue, which can be initialized concurrently. Once the   </div><div class="line">        user's jobs exceed this limit they will be queued on disk.    </div><div class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">      </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.default.init-accept-jobs-factor<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>10<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>The multipe of (maximum-system-jobs * queue-capacity) used to   </div><div class="line">        determine the number of jobs which are accepted by the scheduler.    </div><div class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">      </div><div class="line">      <span class="comment">&lt;!-- The default configuration settings for the capacity task scheduler --&gt;</span>  </div><div class="line">      <span class="comment">&lt;!-- The default values would be applied to all the queues which don't have --&gt;</span>  </div><div class="line">      <span class="comment">&lt;!-- the appropriate property for the particular queue --&gt;</span>  </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.default-supports-priority<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>If true, priorities of jobs will be taken into   </div><div class="line">          account in scheduling decisions by default in a job queue.  </div><div class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">        </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.default-minimum-user-limit-percent<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>100<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>The percentage of the resources limited to a particular user  </div><div class="line">          for the job queue at any given point of time by default.  </div><div class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">      </div><div class="line">      </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.default-user-limit-factor<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>The default multiple of queue-capacity which is used to   </div><div class="line">        determine the amount of slots a single user can consume concurrently.  </div><div class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">      </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.default-maximum-active-tasks-per-queue<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>200000<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>The default maximum number of tasks, across all jobs in the   </div><div class="line">        queue, which can be initialized concurrently. Once the queue's jobs exceed   </div><div class="line">        this limit they will be queued on disk.    </div><div class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">      </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.default-maximum-active-tasks-per-user<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>100000<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>The default maximum number of tasks per-user, across all the of   </div><div class="line">        the user's jobs in the queue, which can be initialized concurrently. Once   </div><div class="line">        the user's jobs exceed this limit they will be queued on disk.    </div><div class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">      </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.default-init-accept-jobs-factor<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>10<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>The default multipe of (maximum-system-jobs * queue-capacity)   </div><div class="line">        used to determine the number of jobs which are accepted by the scheduler.    </div><div class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">      </div><div class="line">      <span class="comment">&lt;!-- Capacity scheduler Job Initialization configuration parameters --&gt;</span>  </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.init-poll-interval<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>5000<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>The amount of time in miliseconds which is used to poll   </div><div class="line">        the job queues for jobs to initialize.  </div><div class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.init-worker-threads<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>5<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span>Number of worker threads which would be used by  </div><div class="line">        Initialization poller to initialize jobs in a set of queue.  </div><div class="line">        If number mentioned in property is equal to number of job queues  </div><div class="line">        then a single thread would initialize jobs in a queue. If lesser  </div><div class="line">        then a thread would get a set of queues assigned. If the number  </div><div class="line">        is greater then number of threads would be equal to number of   </div><div class="line">        job queues.  </div><div class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">      </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.hive.capacity<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>60<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.hive.maximum-capacity<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>80<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.hive.supports-priority<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.hive.minimum-user-limit-percent<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>20<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.hive.user-limit-factor<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>10<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.hive.maximum-initialized-active-tasks<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>200000<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.hive.maximum-initialized-active-tasks-per-user<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>100000<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.hive.init-accept-jobs-factor<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>100<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line"></div><div class="line"><span class="comment">&lt;!--streaming--&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.streaming.capacity<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>30<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.streaming.maximum-capacity<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>90<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.streaming.supports-priority<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.streaming.minimum-user-limit-percent<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>100<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.streaming.user-limit-factor<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.streaming.maximum-initialized-active-tasks<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>200000<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.streaming.maximum-initialized-active-tasks-per-user<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>100000<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </div><div class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </div><div class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.capacity-scheduler.queue.streamingh.init-accept-jobs-factor<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>10<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </div><div class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">        </div><div class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="11-开启机架感知"><a href="#11-开启机架感知" class="headerlink" title="11.          开启机架感知"></a>11.          开启机架感知</h2><h3 id="修改hadoop配置文件core-site-xml-添加机架感知代码"><a href="#修改hadoop配置文件core-site-xml-添加机架感知代码" class="headerlink" title="#修改hadoop配置文件core-site.xml 添加机架感知代码"></a>#修改hadoop配置文件core-site.xml 添加机架感知代码</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>topology.script.file.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/modules/hadoop/hadoop-1.0.3/conf/RackAware.py<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="新建-RackAware-py-文件"><a href="#新建-RackAware-py-文件" class="headerlink" title="#新建 RackAware.py 文件"></a>#新建 RackAware.py 文件</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/python</span></div><div class="line"><span class="comment">#-*-coding:UTF-8 -*-</span></div><div class="line"><span class="keyword">import</span> sys</div><div class="line"></div><div class="line">rack = &#123;<span class="string">"hadoopnode-101"</span>:<span class="string">"rack1"</span>,</div><div class="line">        <span class="string">"hadoopnode-102"</span>:<span class="string">"rack1"</span>,</div><div class="line">        <span class="string">"hadoopnode-203"</span>:<span class="string">"rack2"</span>,</div><div class="line">        <span class="string">"192.168.1.101"</span>:<span class="string">"rack1"</span>,</div><div class="line">        <span class="string">"192.168.1.102"</span>:<span class="string">"rack1"</span>,</div><div class="line">        <span class="string">"192.168.1.203"</span>:<span class="string">"rack2"</span>,</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__==<span class="string">"__main__"</span>:</div><div class="line">    <span class="keyword">print</span> <span class="string">"/"</span> + rack.get(sys.argv[<span class="number">1</span>],<span class="string">"rack0"</span>)</div></pre></td></tr></table></figure>
<h2 id="12-配置详解"><a href="#12-配置详解" class="headerlink" title="12.          配置详解"></a><a href="undefined">12.          配置详解</a></h2><h3 id="Hadoop系统配置详解"><a href="#Hadoop系统配置详解" class="headerlink" title="#Hadoop系统配置详解"></a>#Hadoop系统配置详解</h3><p>#core-site.xml为公共配置,hdfs-site.xml mapred-site.xml 在 hdfs 和mapreduce 启动的时候加载。</p>
<table>
<thead>
<tr>
<th>hadoop-env.sh</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>name</strong></td>
<td><strong>value</strong></td>
<td><strong>含义</strong></td>
<td></td>
</tr>
<tr>
<td>JAVA_HOME</td>
<td>/usr/java/jdk1.6.0_30</td>
<td>JDK所在路径</td>
<td></td>
</tr>
<tr>
<td>JAVA_LIBRARY_PATH</td>
<td>/opt/hadoopgpl/native/Linux-amd64-64:/opt/modules/hadoop/hadoop-0.20.203.0/lib/native/Linux-amd64-64</td>
<td>Lzo,Snappy,gzip  等压缩算法库地址</td>
<td></td>
</tr>
<tr>
<td>HADOOP_HEAPSIZE</td>
<td>26000</td>
<td>最大 HEAPSIZE 大小,默认  1000M</td>
<td></td>
</tr>
<tr>
<td><strong>core-site.xml</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Name</strong></td>
<td><strong>value</strong></td>
<td><strong>含义</strong></td>
<td></td>
</tr>
<tr>
<td>fs.default.name</td>
<td>hdfs://hadoopmaster:9000</td>
<td>指定默认的文件系统，默认端口 8020。</td>
<td></td>
</tr>
<tr>
<td>fs.checkpoint.dir</td>
<td>/data1/hdfs/secondarynamenode,/data2/hdfs/secondarynamenode</td>
<td>辅助NameNode检查点存储目录，分别存储到各个目录，支持冗余备份。</td>
<td></td>
</tr>
<tr>
<td>fs.checkpoint.period</td>
<td>1800</td>
<td>editlog和fsimage,合并触发周期30分钟。</td>
<td></td>
</tr>
<tr>
<td>fs.checkpoint.size</td>
<td>33554432</td>
<td>editlog和fsimage,合并触发日志大小32M。</td>
<td></td>
</tr>
<tr>
<td>fs.trash.interval</td>
<td>1440</td>
<td>文件清理周期 24小时</td>
<td></td>
</tr>
<tr>
<td>io.compression.codecs</td>
<td>org.apache.hadoop.io.compress.DefaultCodec,com.hadoop.compression.lzo.LzoCodec,com.hadoop.compression.lzo.LzopCodec,org.apache.hadoop.io.compress.GzipCodec,org.apache.hadoop.io.compress.BZip2Codec</td>
<td>压缩类库</td>
<td></td>
</tr>
<tr>
<td>io.compression.codec.lzo.class</td>
<td>com.hadoop.compression.lzo.LzoCodec</td>
<td>LZO  编码类</td>
<td></td>
</tr>
<tr>
<td>io.file.buffer.size</td>
<td>65536</td>
<td>指定缓冲区的大小，默认4K太小，64k(65536)或128k(131072)更为常用</td>
<td></td>
</tr>
<tr>
<td>topology.script.file.name</td>
<td>/opt/modules/hadoop/hadoop-0.20.203.0/conf/RackAware.py</td>
<td>配置  机架感知的代码</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>hdfs-site.xml</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Name</strong></td>
<td><strong>Value</strong></td>
<td><strong>含义</strong></td>
<td></td>
</tr>
<tr>
<td>dfs.name.dir</td>
<td>/data1/hadoop/hdfs/name,/data2/hadoop/hdfs/name,/nfs/hadoop/hdfs/name</td>
<td>NameNode上持久化存储元数据和事务日志的路径。指定多个目录的话，各个目录内容完全一致。  使用NFS在加载一个远程目录,以便后续主机宕机,快速恢复。</td>
<td></td>
</tr>
<tr>
<td>dfs.data.dir</td>
<td>/data1/hadoop/hdfs/data  /data2/hadoop/hdfs/data,/data3/hadoop/hdfs/data</td>
<td>DataNode上存储数据块的地方。如果指定多个目录，则数据库被随机的存放。</td>
<td></td>
</tr>
<tr>
<td>dfs.http.address</td>
<td>hadoopmaster:50070</td>
<td>HDFS  管理界面</td>
<td></td>
</tr>
<tr>
<td>dfs.secondary.http.address</td>
<td>hadoopslave:50090</td>
<td>secondary  namenode http 地址</td>
<td></td>
</tr>
<tr>
<td>dfs.replication</td>
<td>整数</td>
<td>数据复制的份数</td>
<td></td>
</tr>
<tr>
<td>dfs.datanode.du.reserved</td>
<td>1073741824</td>
<td>预留文件数量</td>
<td></td>
</tr>
<tr>
<td>dfs.block.size</td>
<td>134217728</td>
<td>HDFS 文件块大小,默认128M</td>
<td></td>
</tr>
<tr>
<td>dfs.datanode.max.xcievers</td>
<td>4096</td>
<td>datanode同时打开的文件上限。默认256太小。</td>
<td></td>
</tr>
<tr>
<td>dfs.permissions</td>
<td>FALSE</td>
<td>默认是 true，则打开前文所述的权限系统。如果是 false，权限检查 就是关闭的</td>
<td></td>
</tr>
<tr>
<td>dfs.support.append</td>
<td>FALSE</td>
<td>支持文件append，主要是支持hbase</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>mapred-size.xml</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Name</strong></td>
<td><strong>Value</strong></td>
<td><strong>说明</strong></td>
<td></td>
</tr>
<tr>
<td>mapred.job.tracker</td>
<td>hadoopmaster:9001</td>
<td>Jobtracker的RPC服务器所在的主机名称和端口。</td>
<td></td>
</tr>
<tr>
<td>mapred.local.dir</td>
<td>/data1/hadoop/mapred/mrlocal,/data2/hadoop/mapred/mrlocal</td>
<td>存储作业中间数据的目录列表，作业结束后，数据被清楚</td>
<td></td>
</tr>
<tr>
<td>mapred.system.dir</td>
<td>/data1/hadoop/mapred/mrsystem</td>
<td>作业运行期间的存储共享目录的目录，必须是HDFS之上的目录</td>
<td></td>
</tr>
<tr>
<td>mapred.task.tracker.map.tasks.maximum</td>
<td>12</td>
<td>运行在tasktracker之上的最大map任务数</td>
<td></td>
</tr>
<tr>
<td>mapred.task.tracker.reduce.tasks.maximum</td>
<td>4</td>
<td>运行在tasktracker之上的最大reduce任务数 (MAP+RED=CPU核心*2) (Map/Red=4/1)</td>
<td></td>
</tr>
<tr>
<td>mapred.child.java.opts</td>
<td>-Xmx1536M</td>
<td>JVM选项，默认 -Xmx200m</td>
<td></td>
</tr>
<tr>
<td>mapred.compress.map.output</td>
<td>true</td>
<td>Map输出后压缩传输,可以缩短文件传输时间</td>
<td></td>
</tr>
<tr>
<td>mapred.map.output.compression.codec</td>
<td>com.hadoop.compression.lzo.LzoCodec</td>
<td>使用Lzo库作为压缩算法</td>
<td></td>
</tr>
<tr>
<td>mapred.child.java.opts</td>
<td>-Djava.library.path=/opt/hadoopgpl/native/Linux-amd64-64</td>
<td>加载Lzo 库</td>
<td></td>
</tr>
<tr>
<td>mapred.jobtracker.taskScheduler</td>
<td>org.apache.hadoop.mapred.CapacityTaskScheduler</td>
<td>使用能力调度器</td>
<td></td>
</tr>
<tr>
<td>mapred.queue.names</td>
<td>default,HIVE,ETL</td>
<td>配置能力调度器队列</td>
<td></td>
</tr>
<tr>
<td>fs.inmemory.size.mb</td>
<td>300</td>
<td>为reduce阶段合并map输出所需的内存文件系统分配更多的内存</td>
<td></td>
</tr>
<tr>
<td>io.sort.mb</td>
<td>300</td>
<td>reduce 排序时的内存上限</td>
<td></td>
</tr>
<tr>
<td>mapred.jobtracker.restart.recover</td>
<td>true</td>
<td>默认:false</td>
<td></td>
</tr>
<tr>
<td>mapred.reduce.parallel.copies</td>
<td>10</td>
<td>默认:5 ,reduce 并行  copy的线程数</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>masters</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Value</strong></td>
<td><strong>说明</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>hadoopslave</td>
<td></td>
<td>SecondaryNameNode HostName地址</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>slaves</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Value</strong></td>
<td><strong>说明</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>datanode1</td>
<td></td>
<td>DataNode  TaskTracker HostName 地址列表</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>样例</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="http://hadoop.apache.org/common/docs/r0.20.2/core-default.html" target="_blank" rel="external">http://hadoop.apache.org/common/docs/r0.20.2/core-default.html</a></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="http://hadoop.apache.org/common/docs/r0.20.2/hdfs-default.html" target="_blank" rel="external">http://hadoop.apache.org/common/docs/r0.20.2/hdfs-default.html</a></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="http://hadoop.apache.org/common/docs/r0.20.0/mapred-default.html" target="_blank" rel="external">http://hadoop.apache.org/common/docs/r0.20.0/mapred-default.html</a></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="机器配置推荐"><a href="#机器配置推荐" class="headerlink" title="#机器配置推荐"></a>#机器配置推荐</h3><table>
<thead>
<tr>
<th>编号</th>
<th>机器类型</th>
<th>系统</th>
<th>数量</th>
<th>CPU</th>
<th>内存</th>
<th>硬盘</th>
<th>网卡</th>
<th>推荐机型</th>
<th>说明</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>网络设备</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>交换机</td>
<td>千兆以太网交换机</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>华为8512</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>核心和管理节点</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>NameNode</td>
<td>CentOS  5.8</td>
<td>1</td>
<td>2*4核</td>
<td>ECC  DDR2 96G</td>
<td>SATA  1T+1T*3(RAID 10)</td>
<td>千兆以太网卡*2</td>
<td>Dell(R410),HP(DL160)</td>
<td>配置相同,故障可以快速切换</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>Secondary  NameNode</td>
<td>CentOS  5.8</td>
<td>1</td>
<td>2*4核</td>
<td>ECC  DDR2 96G</td>
<td>SATA  1T+1T*3(RAID 10)</td>
<td>千兆以太网卡*2</td>
<td>Dell(R410),HP(DL160)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>JobTracker</td>
<td>CentOS  5.8</td>
<td>1</td>
<td>2*4核</td>
<td>ECC  DDR2 32G</td>
<td>SATA  1T+1T*3(RAID 10)</td>
<td>千兆以太网卡*2</td>
<td>Dell(R410),HP(DL160)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>负载均衡(HaProxy)</td>
<td>CentOS  5.8</td>
<td>2</td>
<td>2*4核</td>
<td>ECC  DDR2 8~16G</td>
<td>SATA  500G+(RAID 10)</td>
<td>千兆以太网卡*2</td>
<td>Dell(R410),HP(DL160)</td>
<td>互备</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>监控管理(Cacti Nagios Ganglia)</td>
<td>CentOS  5.8</td>
<td>1</td>
<td>2*4核</td>
<td>ECC  DDR2 8~16G</td>
<td>SATA  500G+(RAID 10)</td>
<td>千兆以太网卡*2</td>
<td>Dell(R410),HP(DL160)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>7</td>
<td>Hive  MetaStore DB Server (Mysql)</td>
<td>CentOS  5.9</td>
<td>2</td>
<td>2*5核</td>
<td>ECC  DDR2 8~16G</td>
<td>SATA  500G+(RAID 10)</td>
<td>千兆以太网卡*2</td>
<td>Dell(R410),HP(DL160)</td>
<td>压力较小</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>存储和运算节点</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>5</td>
<td>DataNode+TaskTracker</td>
<td>CentOS  5.8</td>
<td>N</td>
<td>2*4核</td>
<td>ECC  DDR2 16~32G</td>
<td>SATA  2T+2T*(3~12)</td>
<td>千兆以太网卡*2</td>
<td>Dell(R410,R510)</td>
<td>磁盘不做 RAID</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>HiveServer</td>
<td>CentOS  5.8</td>
<td>2</td>
<td>2*4核</td>
<td>ECC  DDR2 32G</td>
<td>SATA  2T</td>
<td>千兆以太网卡*2</td>
<td>Dell(R410),HP(DL160)</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="EasyHive仓库集群部署入门"><a href="#EasyHive仓库集群部署入门" class="headerlink" title="EasyHive仓库集群部署入门"></a>EasyHive仓库集群部署入门</h1><p><img src="file://localhost/Users/xialinsheng/Library/Group%20Containers/UBF8T346G9.Office/msoclip1/01/clip_image028.png" alt="img"></p>
<h2 id="1-名词解释"><a href="#1-名词解释" class="headerlink" title="1.  名词解释"></a><a href="undefined">1.  名词解释</a></h2><p>\1. Hive,由facebook 开源的数据仓库系统,可以基于Hql语句操作Hadoop集群数据。</p>
<p>\2. Mysql,开源数据库系统,H ive 存储原数据使用。</p>
<p>\3. FineReport 一个简单易用的快速报表研发工具。</p>
<p>\4. alexa 国际知名网站排名统计</p>
<p>\5. Sogou 数据资源,<a href="http://www.sogou.com/labs/resources.html" target="_blank" rel="external">http://www.sogou.com/labs/resources.html</a></p>
<h2 id="2-Hive的作用和原理说明"><a href="#2-Hive的作用和原理说明" class="headerlink" title="2.  Hive的作用和原理说明"></a><a href="undefined">2.  Hive</a>的作用和原理说明</h2><h3 id="Hadoop仓库和传统数据仓库的协作结构图"><a href="#Hadoop仓库和传统数据仓库的协作结构图" class="headerlink" title="#Hadoop仓库和传统数据仓库的协作结构图"></a><a href="undefined">#Hadoop</a>仓库和传统数据仓库的协作结构图</h3><p><img src="file://localhost/Users/xialinsheng/Library/Group%20Containers/UBF8T346G9.Office/msoclip1/01/clip_image030.png" alt="img"></p>
<p>属于互为补充的关系,相比传统数据仓库技术,Hadoop仓库更合适做非结构化数据分析。</p>
<h3 id="Hadoop-Hive仓库数据日志分析流向图"><a href="#Hadoop-Hive仓库数据日志分析流向图" class="headerlink" title="#Hadoop/Hive仓库数据日志分析流向图"></a><a href="undefined">#Hadoop/Hive</a>仓库数据日志分析流向图</h3><p><img src="file://localhost/Users/xialinsheng/Library/Group%20Containers/UBF8T346G9.Office/msoclip1/01/clip_image032.png" alt="img"></p>
<p><img src="file://localhost/Users/xialinsheng/Library/Group%20Containers/UBF8T346G9.Office/msoclip1/01/clip_image034.png" alt="img"></p>
<h3 id="hive内部结构图"><a href="#hive内部结构图" class="headerlink" title="#hive内部结构图"></a><a href="undefined">#hive</a>内部结构图</h3><p><img src="file://localhost/Users/xialinsheng/Library/Group%20Containers/UBF8T346G9.Office/msoclip1/01/clip_image036.png" alt="img"></p>
<h2 id="3-Hive-部署和安装"><a href="#3-Hive-部署和安装" class="headerlink" title="3.  Hive 部署和安装"></a><a href="undefined">3.  Hive </a>部署和安装</h2><h3 id="安装Hadoop集群-看EasyHadoop集群部署入门章节。"><a href="#安装Hadoop集群-看EasyHadoop集群部署入门章节。" class="headerlink" title=" #安装Hadoop集群,看EasyHadoop集群部署入门章节。"></a><a href="undefined"> #</a>安装Hadoop集群,看EasyHadoop集群部署入门章节。</h3><h3 id="编译安装Mysql-启动Mysql-检查gc-包。"><a href="#编译安装Mysql-启动Mysql-检查gc-包。" class="headerlink" title="#编译安装Mysql,启动Mysql,检查gc++包。"></a><a href="undefined">#</a>编译安装Mysql,启动Mysql,检查gc++包。</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">##/bin/sh</span></div><div class="line"><span class="built_in">cd</span> /opt/modules/src</div><div class="line">wget http://ftp.gnu.org/pub/gnu/ncurses/ncurses-5.6.tar.gz</div><div class="line">tar zxvf ncurses-5.6.tar.gz</div><div class="line"><span class="built_in">cd</span> ncurses-5.6</div><div class="line">./configure -prefix=/usr -with-shared -without-debug</div><div class="line">make &amp;&amp; make install clean</div><div class="line"></div><div class="line">wget http://60.28.110.228/<span class="built_in">source</span>/package/mysql-5.1.42.tar.gz</div><div class="line">tar -xzvf mysql-5.1.42.tar.gz</div><div class="line"><span class="built_in">cd</span> mysql-5.1.42</div><div class="line">./configure  <span class="string">'--with-embedded-server'</span> <span class="string">'--with-comment=MySQL Community Server (GPL)'</span> <span class="string">'--with-mysqld-ldflags=-static'</span> <span class="string">'--with-client-ldflags=-static'</span> <span class="string">'--enable-assembler'</span> <span class="string">'--enable-local-infile'</span> <span class="string">'--with-fast-mutexes'</span> <span class="string">'--with-mysqld-user=mysql'</span> <span class="string">'--with-unix-socket-path=/var/lib/mysql/mysql.sock'</span> <span class="string">'--with-pic'</span> <span class="string">'--prefix=/opt/modules/mysql/'</span> <span class="string">'--with-extra-charsets=complex'</span> <span class="string">'--with-ssl'</span> <span class="string">'--sysconfdir=/etc'</span> <span class="string">'--datadir=/opt/data/modules/mysql/'</span> <span class="string">'--enable-thread-safe-client'</span> <span class="string">'--with-readline'</span> <span class="string">'--with-innodb'</span> <span class="string">'--with-plugin-innodb_plugin'</span> <span class="string">'--without-ndbcluster'</span> <span class="string">'--with-archive-storage-engine'</span> <span class="string">'--with-csv-storage-engine'</span> <span class="string">'--with-blackhole-storage-engine'</span> <span class="string">'--with-federated-storage-engine'</span> <span class="string">'--without-plugin-daemon_example'</span> <span class="string">'--without-plugin-ftexample'</span> <span class="string">'--with-partition'</span> <span class="string">'--with-big-tables'</span> <span class="string">'--with-zlib-dir=bundled'</span> <span class="string">'--enable-shared'</span> <span class="string">'CC=gcc'</span> <span class="string">'CFLAGS=-O2 -g -pipe'</span> <span class="string">'LDFLAGS='</span> <span class="string">'CXX=gcc'</span> <span class="string">'CXXFLAGS=-O2 -g -pipe -felide-constructors -fno-exceptions -fno-rtti '</span></div><div class="line"></div><div class="line">make &amp;&amp; make install </div><div class="line">/usr/sbin/groupadd mysql </div><div class="line">/usr/sbin/useradd -g mysql mysql</div><div class="line">mkdir -p  /opt/data/modules/mysql/logs/</div><div class="line">mkdir -p  /opt/data/modules/mysql/data/</div><div class="line">./scripts/mysql_install_db</div><div class="line">chown -R mysql:mysql /opt/data/modules/mysql/</div><div class="line">chown -R mysql:mysql /opt/modules/mysql/var</div><div class="line">/opt/modules/mysql/bin/mysqld_safe &amp;</div></pre></td></tr></table></figure>
<p> <a href="undefined">   </a> #RPM 安装Mysql server </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#http://mirrors.oss.org.cn/mysql/MySQL-6.0/?C=M;O=D 下载地址!</span></div><div class="line"></div><div class="line"><span class="comment">#mysql server</span></div><div class="line">rpm -ivh MySQL-server-community-6.0.11-0.rhel5.i386.rpm</div><div class="line"></div><div class="line"><span class="comment">#mysql client </span></div><div class="line">rpm -ivh MySQL-client-community-6.0.11-0.rhel5.i386.rpm</div></pre></td></tr></table></figure>
<pre><code>#启动mysql服务器   

/sbin/service mysql start
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[root@master ~]# /sbin/service mysql restart</div><div class="line">Shutting down MySQL..                                      [  OK  ]</div><div class="line">Starting MySQL.                                            [  OK  ]</div></pre></td></tr></table></figure>
<h3 id="登陆Mysql-服务器"><a href="#登陆Mysql-服务器" class="headerlink" title="#登陆Mysql 服务器"></a>#登陆Mysql 服务器</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql -uroot -p</div></pre></td></tr></table></figure>
<h3 id="添加Hive用户名和密码"><a href="#添加Hive用户名和密码" class="headerlink" title="#添加Hive用户名和密码"></a>#添加Hive用户名和密码</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#2).授权法。例如,你想myuser使用mypassword从任何主机连接到mysql服务器的话。</span></div><div class="line">GRANT ALL PRIVILEGES ON *.* TO <span class="string">'hive'</span>@<span class="string">'%'</span> IDENTIFIED BY <span class="string">'hive'</span> WITH GRANT OPTION ;</div><div class="line"><span class="comment">#如果你想允许用户myuser从ip为192.168.1.%的主机连接到mysql服务器，并使用mypassword作为密码 </span></div><div class="line">GRANT ALL PRIVILEGES ON *.* TO <span class="string">'hive'</span>@<span class="string">'192.168.1.%'</span> IDENTIFIED BY <span class="string">'hive'</span> WITH GRANT OPTION;</div><div class="line"><span class="comment">#我用的第一个方法,刚开始发现不行,在网上查了一下,少执行一个语句</span></div><div class="line"></div><div class="line">mysql&gt;FLUSH PRIVILEGES</div><div class="line"></div><div class="line"><span class="comment">#使修改生效，就可以了</span></div><div class="line"><span class="comment">#遗留问题</span></div><div class="line">[root@master ~]<span class="comment"># mysql -uhive -phive -h192.168.1.100</span></div><div class="line">ERROR 1130 (HY000): Host <span class="string">'::ffff:192.168.1.100'</span> is not allowed to connect to this MySQL server</div></pre></td></tr></table></figure>
<h3 id="解压Hive包并配置JDBC连接地址。"><a href="#解压Hive包并配置JDBC连接地址。" class="headerlink" title="#解压Hive包并配置JDBC连接地址。"></a>#解压Hive包并配置JDBC连接地址。</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">mkdir -p  /opt/modules/hive/</div><div class="line">cp hive-0.9.0.tar.gz /opt/modules/</div><div class="line"><span class="built_in">cd</span> /opt/modules/</div><div class="line">tar -xzvf hive-0.9.0.tar.gz</div><div class="line">cp mysql-connector-java-5.1.20-bin.jar  /opt/modules/hive/hive-0.9.0/lib/</div></pre></td></tr></table></figure>
<h4 id="编辑配置Hive默认文件"><a href="#编辑配置Hive默认文件" class="headerlink" title="#编辑配置Hive默认文件"></a>#编辑配置Hive默认文件</h4><p>cp/opt/modules/hive/hive-0.9.0/conf/hive-env.sh.template/opt/modules/hive/hive-0.9.0/conf/hive-env.sh</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">export</span> HADOOP_HEAPSIZE=64 <span class="comment">#默认1024m</span></div></pre></td></tr></table></figure>
<p>cp /opt/modules/hive/hive-0.9.0/conf/hive-default.xml.template/opt/modules/hive-0.9.0/conf/hive-site.xml</p>
<p>vi /opt/modules/hive/hive-0.9.0/conf/hive-site.xml </p>
<h4 id="修改一下hive-site-mysql-JDBC节点内容"><a href="#修改一下hive-site-mysql-JDBC节点内容" class="headerlink" title="#修改一下hive-site mysql JDBC节点内容"></a>#修改一下hive-site mysql JDBC节点内容</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://192.168.1.100:3306/hive?createDatabaseIfNotExist=true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>JDBC connect string for a JDBC metastore<span class="tag">&lt;/<span class="name">description</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>Driver class name for a JDBC metastore<span class="tag">&lt;/<span class="name">description</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>hive<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>username to use against metastore database<span class="tag">&lt;/<span class="name">description</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>hive<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>password to use against metastore database<span class="tag">&lt;/<span class="name">description</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="添加Mysql-Hive用户名和密码-创建Hive-仓库"><a href="#添加Mysql-Hive用户名和密码-创建Hive-仓库" class="headerlink" title=" #添加Mysql Hive用户名和密码,创建Hive 仓库"></a><a href="undefined"> #</a>添加Mysql Hive用户名和密码,创建Hive 仓库</h3><h4 id="登陆mysql-服务器"><a href="#登陆mysql-服务器" class="headerlink" title="#登陆mysql 服务器"></a>#登陆mysql 服务器</h4><p>/opt/modules/mysql/bin/mysql -uroot -p</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#创建Hive metastore</span></div><div class="line">create database hive;</div></pre></td></tr></table></figure>
<h3 id="启动Hive-thrift-Server"><a href="#启动Hive-thrift-Server" class="headerlink" title="#启动Hive thrift Server"></a>#启动Hive thrift Server</h3><h4 id="启动hive-server"><a href="#启动hive-server" class="headerlink" title="#启动hive server"></a>#启动hive server</h4><p>/opt/modules/hive/hive-0.9.0/bin/hive–service hiveserver 10001</p>
<h4 id="测试"><a href="#测试" class="headerlink" title="#测试"></a>#测试</h4><p>netstat -nap |grep 10001</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@hadoop-231 bin]<span class="comment">#netstat -nap |grep 10001</span></div><div class="line">tcp        0      0 :::10001                    :::*                        LISTEN      31166/java</div></pre></td></tr></table></figure>
<h3 id="启动内置的Hive-UI。"><a href="#启动内置的Hive-UI。" class="headerlink" title="#启动内置的Hive UI。"></a><a href="undefined">#</a>启动内置的Hive UI。</h3><p>/opt/modules/hive/hive-0.9.0/bin/hive–service hwi</p>
<p><img src="file://localhost/Users/xialinsheng/Library/Group%20Containers/UBF8T346G9.Office/msoclip1/01/clip_image038.png" alt="img"></p>
<h2 id="4-Hive-Cli-的基本用法"><a href="#4-Hive-Cli-的基本用法" class="headerlink" title="4.  Hive Cli 的基本用法"></a><a href="undefined">4.  Hive Cli </a>的基本用法</h2><p>  cd /opt/modules/hive/hive-0.9.0/bin/</p>
<h3 id="登陆查询"><a href="#登陆查询" class="headerlink" title="#登陆查询"></a><a href="undefined">#</a>登陆查询</h3><p>#执行hive 命令到 hive 命令行模式下面</p>
<p>./hive </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[root@hadoop-231 bin]<span class="comment">#./hive</span></div><div class="line">hive&gt; show databases;</div><div class="line">OK</div><div class="line">alexa</div><div class="line">default</div><div class="line"><span class="built_in">test</span></div><div class="line">Time taken: 3.103 seconds</div><div class="line">hive&gt;</div></pre></td></tr></table></figure>
<h3 id="查询文件方式"><a href="#查询文件方式" class="headerlink" title="#查询文件方式"></a><a href="undefined">#</a>查询文件方式</h3><h4 id="编辑一个HQL-文件"><a href="#编辑一个HQL-文件" class="headerlink" title="#编辑一个HQL 文件"></a>#编辑一个HQL 文件</h4><p>vi test.q</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">use <span class="built_in">test</span>;</div><div class="line">select * from test_text <span class="built_in">limit</span> 30;</div></pre></td></tr></table></figure>
<h4 id="读取查询文件查询方式"><a href="#读取查询文件查询方式" class="headerlink" title="#读取查询文件查询方式"></a>#读取查询文件查询方式</h4><p>./hive -f test.q</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">[root@hadoop-231 bin]<span class="comment">#./hive -f test.q </span></div><div class="line">Hive <span class="built_in">history</span> file=/tmp/root/hive_job_log_root_201207281215_1090497680.txt</div><div class="line">OK</div><div class="line">Time taken: 3.306 seconds</div><div class="line">OK</div><div class="line">12944   28595   34502</div><div class="line">11412   27522   34974</div><div class="line">17982   27989   30923</div><div class="line">17813   26214   38065</div><div class="line">.........................................................</div></pre></td></tr></table></figure>
<h3 id="命令行模式"><a href="#命令行模式" class="headerlink" title="#命令行模式"></a><a href="undefined">#</a>命令行模式</h3><p>./hive -e “select * fromtest.test_text limit 30”</p>
<p>#效果同上</p>
<h2 id="5-HQL基本语法-创建表-加载表-分析查询-删除表"><a href="#5-HQL基本语法-创建表-加载表-分析查询-删除表" class="headerlink" title="5.  HQL基本语法 (创建表,加载表,分析查询,删除表)"></a><a href="undefined">5.  HQL</a>基本语法 (创建表,加载表,分析查询,删除表)</h2><h3 id="快速案例"><a href="#快速案例" class="headerlink" title="#快速案例"></a><a href="undefined">#</a>快速案例</h3><p>./hive #登陆hive Cli模式</p>
<p>CREATEdatabase alexa; #建库</p>
<p>usealexa;</p>
<p>create  table uid3(uid string)</p>
<p>PARTITIONED BY(dt STRING)</p>
<p>ROW FORMAT DELIMITED FIELDSTERMINATED BY ‘\t’</p>
<p>collectionitems terminated by “\n”</p>
<p>STOREDAS TEXTFILE</p>
<p>LOCATION’/data/dw/demo/uid3/‘</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">CREATE TABLE top100w (id BIGINT,domain STRING COMMENT <span class="string">'alexa domain'</span>)</div><div class="line"> COMMENT <span class="string">'alexa top100w'</span></div><div class="line">ROW FORMAT DELIMITED FIELDS TERMINATED BY <span class="string">','</span></div><div class="line">collection items terminated by <span class="string">"\n"</span> </div><div class="line">STORED AS TEXTFILE</div></pre></td></tr></table></figure>
<p>LOADDATA  LOCAL INPATH ‘/root/top-1m.csv’OVERWRITE INTO TABLE top100w; #加载</p>
<p>LOADDATA  INPATH’/data/dw/top100w/top-1m.csv’ OVERWRITE INTO TABLE top100w; #加载</p>
<p>loaddata inpath ‘/data/uid.txt’ overwrite into table uid;</p>
<p>#测试</p>
<p>SELECT* FROM alexa.top100w limit 100; </p>
<p>select* from alexa.top100w where domain=”itcast.cn” </p>
<h3 id="创建表"><a href="#创建表" class="headerlink" title="#创建表"></a>#创建表</h3><p>  a.内部表创建</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">CREATE TABLE top100w (id BIGINT,domain STRING) COMMENT <span class="string">'alexa top100w'</span></div></pre></td></tr></table></figure>
<p>  b.外部表创建</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">CREATE EXTERNAL TABLE top100w (id BIGINT,domain STRING COMMENT <span class="string">'alexa domain'</span>)</div><div class="line"> COMMENT <span class="string">'alexa top100w'</span></div><div class="line">ROW FORMAT DELIMITED FIELDS TERMINATED BY <span class="string">','</span></div><div class="line">collection items terminated by <span class="string">"\n"</span> </div><div class="line">STORED AS TEXTFILE</div><div class="line">LOCATION <span class="string">'/data/dw/alexa/top100w/'</span></div></pre></td></tr></table></figure>
<h3 id="加载数据"><a href="#加载数据" class="headerlink" title="#加载数据"></a>#加载数据</h3><p>  #加载数据到外部表使用 put 或者 copyFromLocal</p>
<p>  Hadoop fs -mkdir /data/dw/alexa/top100w/</p>
<p>  hadoop fs -put /root/top-1m.csv /data/dw/alexa/top100w/</p>
<p>  #检查</p>
<p> Select * from alexa.top100w limit 100;</p>
<p>  #加载数据到内部表</p>
<p>  LOADDATA LOCAL INPATH ‘/home/hadoop/top100w.csv’ OVERWRITE INTO TABLE log;</p>
<h3 id="分析查询"><a href="#分析查询" class="headerlink" title="#分析查询"></a>#分析查询</h3><ol>
<li><p>简单查询 select * from top100w limit 10 分析背后原理</p>
</li>
<li><p>简单查询 select a from top100w limit 10  分析背后原理</p>
<p>3.where 练习</p>
<p>4.group by 练习</p>
<p>5.order by 练习</p>
<p>6.union all 练习</p>
<p>7.INSERT OVERWRITE TABLE 练习</p>
<p>8.INSERT OVERWRITE DIRECTORY ‘/user/facebook/tmp/pv_age_sum’</p>
<p>9.SELECT a.key, a.value FROM a WHERE a.key in (SELECT b.key FROM B) -&gt; SELECTa.key, a.val FROM a LEFT SEMI JOIN b on (a.key = b.key)</p>
<p>10.Hive 函数查询方法 查询地址: <a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual" target="_blank" rel="external">https://cwiki.apache.org/confluence/display/Hive/LanguageManual</a></p>
<p>11.dfs 操作命令</p>
</li>
</ol>
<h2 id="6-使用hive到Mysql构建简单数据集市"><a href="#6-使用hive到Mysql构建简单数据集市" class="headerlink" title="6.  使用hive到Mysql构建简单数据集市"></a><a href="undefined">6.  使用hive</a>到Mysql构建简单数据集市</h2><h3 id="创建一个数据表使用Hivecli-进行数据分析"><a href="#创建一个数据表使用Hivecli-进行数据分析" class="headerlink" title="#创建一个数据表使用Hivecli 进行数据分析"></a><a href="undefined">#</a>创建一个数据表使用Hivecli 进行数据分析</h3><h3 id="使用shell-编写Hsql-并使用HiveCli导出数据-使用Mysql命令加载到数据库中。"><a href="#使用shell-编写Hsql-并使用HiveCli导出数据-使用Mysql命令加载到数据库中。" class="headerlink" title="#使用shell 编写Hsql 并使用HiveCli导出数据,使用Mysql命令加载到数据库中。"></a><a href="undefined">#</a>使用shell 编写Hsql 并使用HiveCli导出数据,使用Mysql命令加载到数据库中。</h3><h3 id="使用crontab-新增每日运行任务定时器"><a href="#使用crontab-新增每日运行任务定时器" class="headerlink" title="#使用crontab 新增每日运行任务定时器"></a><a href="undefined">#</a>使用crontab 新增每日运行任务定时器</h3><p> crontab -e</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">50 02 * * *  /opt/<span class="built_in">jobs</span>/top100w.sh</div></pre></td></tr></table></figure>
<h2 id="7-使用FineReport-数据展现数据"><a href="#7-使用FineReport-数据展现数据" class="headerlink" title="7.  使用FineReport 数据展现数据"></a><a href="undefined">7.  使用FineReport </a>数据展现数据</h2><h3 id="安装FineReport-使用注册码"><a href="#安装FineReport-使用注册码" class="headerlink" title="#安装FineReport,使用注册码"></a><a href="undefined">#</a>安装FineReport,使用注册码</h3><h3 id="使用FineReport-快速展现数据报表"><a href="#使用FineReport-快速展现数据报表" class="headerlink" title="#使用FineReport,快速展现数据报表"></a><a href="undefined">#</a>使用FineReport,快速展现数据报表</h3><h2 id="8-练习"><a href="#8-练习" class="headerlink" title="8.  练习"></a>8.  练习</h2><p>\1. 下载 <a href="http://www.sogou.com/labs/dl/q.html" target="_blank" rel="external">http://www.sogou.com/labs/dl/q.html</a>完整版(1.9GB)</p>
<p>\2. 计算出网民搜索行为曲线,并用图表展现</p>
<p>\3. 计算出关键词搜索行为次数排行榜</p>
<p>\4. 计算出域名访问排行榜</p>
<p>思考题:通过挖掘日志如何改进搜索结果,那个URL才是用户想要的?</p>
<p>\5. 使用日志计算出每个点击URL的用户行为权重</p>
<p>\6. 下载其他搜狗数据库做练习</p>
<p>搜狗行为库结构:</p>
<p>访问时间\t用户ID\t[查询词]\t该URL在返回结果中的排名\t用户点击的顺序号\t用户点击的URL</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">logtime string </div><div class="line">user bigint</div><div class="line">keyword string</div><div class="line">rank int</div><div class="line">clickrank int</div><div class="line">url string </div><div class="line"></div><div class="line">CREATE EXTERNAL TABLE sogouq (logtime string,user bigint,keyword string,rank int,clickrank int,url string )</div><div class="line"> COMMENT <span class="string">'sogou click log'</span></div><div class="line">ROW FORMAT DELIMITED FIELDS TERMINATED BY <span class="string">'\t'</span></div><div class="line">collection items terminated by <span class="string">"\n"</span> </div><div class="line">STORED AS TEXTFILE</div><div class="line">LOCATION <span class="string">'/data/dw/sogouq/'</span></div><div class="line"></div><div class="line">CREATE TABLE clicklog2 (logtime string,user bigint,keyword string,rank int,clickrank int,url string )</div><div class="line"> COMMENT <span class="string">'sogou click log'</span></div><div class="line">PARTITIONED BY(dt STRING)</div><div class="line">ROW FORMAT DELIMITED FIELDS TERMINATED BY <span class="string">'\t'</span></div><div class="line">collection items terminated by <span class="string">"\n"</span> </div><div class="line">STORED AS TEXTFILE</div><div class="line"></div><div class="line">select c.hour,count(*) from (select split(logtime,<span class="string">':'</span>)[0] hour from clicklog) c group by c.hour;</div><div class="line"></div><div class="line">CREATE TABLE `click_stat` (</div><div class="line">   `stat_hour` varchar(4) DEFAULT NULL,</div><div class="line">   `click_count` int(11) DEFAULT NULL</div><div class="line"> ) ENGINE=MyISAM DEFAULT CHARSET=utf8</div><div class="line"></div><div class="line"> mysql -uhive -phive -h192.168.1.100 --local-infile <span class="_">-e</span> <span class="string">"use test;LOAD DATA LOCAL INFILE 'click_hour.csv' REPLACE INTO TABLE click_stat CHARACTER SET utf8 FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' ( stat_hour,click_count)"</span></div><div class="line"></div><div class="line"></div><div class="line">14:00 23232323232  Hadoop 3  2  easyhadoo.cpm</div><div class="line"> </div><div class="line">Hadoop apache</div><div class="line">Hadoop china</div><div class="line">easyhadoop</div><div class="line">Csnd hadoop </div><div class="line"></div><div class="line"></div><div class="line">iconv <span class="_">-f</span> GBK -t UTF-8 access_log.20080611.decode.filter &gt; access_log.20080611</div><div class="line">iconv <span class="_">-f</span> GB18030 -t UTF-8 access_log.20080611.decode.filter &gt; access_log.20080611</div><div class="line">/opt/modules/hadoop-1.0.3/bin/hadoop fs -copyFromLocal access_log.20080611 /data/dw/sogouq/dt=20080611/</div><div class="line"></div><div class="line">alter table sogouq add  partition(dt=20080602)  location <span class="string">'/data/dw/sogouq/dt=20080602/'</span>;</div><div class="line">访问 http://hive.easyhadoop.com/ 进行在线练习</div></pre></td></tr></table></figure>
<p>==后续课程==</p>
<p>Hive 数据仓库编程和高级应用</p>
<p>1.HiveServer HA (使用haproxy提高HiveServer可用性)</p>
<p>2.使用JDBC 连接Hive进行查询和分析</p>
<p>3.使用Lzo压缩优化数据存储容量</p>
<p>3.使用正则表达式加载数据</p>
<p>4.使用Hive分区优化查询</p>
<p>5.HQL高级语法</p>
<p>6.编写UDF函数</p>
<p>7.编写Hive自定义MapReduce脚本优化查询</p>
<p>8 编写UDAF自定义函数</p>
<p>9.Hive内存优化查询性能优化</p>
<p>———————– 大数据接收 存储 分析 展现方案 ————————-</p>
<p>nginx –&gt; scribe(flume) –&gt; Hadoop–&gt; Hive–&gt;sqoop[ETL] –&gt; oozie[工作流] –&gt; inforbirght –&gt; java+Highcharts</p>
<pre><code>--&gt;haproxy--&gt; phphiveadmin--&gt; 用户

 --&gt;Hbase  --&gt; java+Highcharts
</code></pre><p>(大云,用户日志查询)</p>
<p>10.使用Sqoop进行数据分析</p>
<p>11.使用oozie配置工作流</p>
<p>12.使用Inforbright 构建大型数据集市</p>
<p>13.使用Java+Highcharts构建动态报表</p>
<p>14.Hive+phpHiveAdmin部署和安装仓库自助查询系统</p>
<p>  a.编译安装nginx+php并运行</p>
<p>  b.修改phpHiveAdmin配置文件</p>
<p>-———————–</p>
<p>15.构建基于Hive的OLAP应用</p>
<h1 id="EasyPig数据流分析集群部署入门"><a href="#EasyPig数据流分析集群部署入门" class="headerlink" title="EasyPig数据流分析集群部署入门"></a>EasyPig数据流分析集群部署入门</h1><h3 id="1-数据测试"><a href="#1-数据测试" class="headerlink" title="1.数据测试"></a>1.数据测试</h3><p>#从 top100w 中查询出 itcast.cn 的 alexa 排名</p>
<p>top100w= load ‘/data/dw/top100w/top-1m.csv’using PigStorage(‘,’) as (id:int,domain:chararray);</p>
<p>fltrd = FILTER top100w by domain==’itcast.cn’</p>
<p>itcast = FOREACH fltrd GENERATE id,domain;</p>
<p>store itcast into ‘/data/itcast.out’</p>

    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用多说评论 -->
    <link rel="stylesheet" href="/css/duoshuo.min.css">
<style>
    #ds-thread #ds-reset .ds-post-button{
        background-color: #0097A7 !important;
    }
    #ds-wrapper #ds-reset .ds-icons-32{
        background-color: #0097A7 !important;
    }
    #ds-reset .ds-highlight {
        color: #0097A7 !important;
    }
</style>
<div id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread"
        data-thread-key=""
        data-url="https://stanxia.github.io/2017/03/21/EasyHadoop集群部署入门/"
        data-title="EasyHadoop集群部署入门">
    </div>
    <!-- 多说评论框 end -->
</div>





                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/04/24/test-youtube/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/03/20/Hadoop-HA配置/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="夏's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        xooglexls@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    <li id="sidebar-first-li">
        <a href="/" target="_self">
            <i class="material-icons sidebar-material-icons">home</i>
            主页
        </a>
    </li>

    <!-- I'm Feeling Lucky -->
    <!--
    <li class="dropdown">
        <a href="" target="_self">
            <i class="material-icons sidebar-material-icons">explore</i>
             sidebar.imlucky
        </a>
    </li>
    -->

    <!-- Archives  -->
    <li class="dropdown">
        <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
            <i class="material-icons sidebar-material-icons">inbox</i>
             归档
            <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
            <li>
            <a class="sidebar_archives-link" href="/archives/2017/04/">四月 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">三月 2017<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/02/">二月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/01/">一月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/05/">五月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/03/">三月 2016<span class="sidebar_archives-count">12</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/02/">二月 2016<span class="sidebar_archives-count">20</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/01/">一月 2016<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/03/">三月 2015<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/02/">二月 2015<span class="sidebar_archives-count">1</span></a>
        </ul>
    </li>

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/hadoop/">hadoop<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/hexo/">hexo<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/java/">java<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/linux/">linux<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/大数据/">大数据<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/categories/大数据手册/">大数据手册<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/大数据案例/">大数据案例<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/技术向/">技术向<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/折腾/">折腾<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/数据库/">数据库<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/漫画/">漫画<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/版本控制/">版本控制<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/生活/">生活<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/电影/">电影<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/问题集锦/">问题集锦<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/categories/集群搭建/">集群搭建<span class="sidebar_archives-count">9</span></a>
            </ul>
        </li>
    

    <!-- Divider -->
    <li class="divider"></li>


    <!-- Pages  -->
  	
        <li>
            <a href="/aboutme/" title="Astan">
                
                Astan
            </a>
        </li>
  	
        <li>
            <a href="/tags/" title="标签索引">
                
                标签索引
            </a>
        </li>
  	
        <li>
            <a href="/guestbook/" title="壮士请留步">
                
                壮士请留步
            </a>
        </li>
  	
        <li>
            <a href="/links" title="常用链接">
                
                常用链接
            </a>
        </li>
  	
        <li>
            <a href="/gallery" title="邓紫棋">
                
                邓紫棋
            </a>
        </li>
  	

    <!-- Article Numebr  -->
    <li>
        <a href="/archives">
            文章总数
            <span class="sidebar-badge">48</span>
        </a>
    </li>
</ul>


        <!-- Sidebar Divider -->
        <div class="sidebar-divider"></div>

        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Theme Material -->
<a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
        主题 - Material
        <span class="sidebar-badge badge-circle">i</span>
    </div>
</a>

<!-- Help & Support -->
<!--
<a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
    sidebar.help
    <span class="mdl-button__ripple-container">
      <span class="mdl-ripple"></span>
    </span>
  </div>
</a>
-->

<!-- Feedback -->
<!--
<a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.feedback
                    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>
-->

<!-- Abount Theme -->
<!--
<a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.about_theme
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>-->

    </div>

    <!-- Sidebar Sponsor -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/twitter" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-twitter.png);">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/profile.php?id=100014686742374" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-facebook.png);">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://www.google.com/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-gplus.png);">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    
        <a href="http://weibo.com/u/1789803763/home?leftnav=1" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-weibo.png);">
                <span class="visuallyhidden">Weibo</span>
            </button><!--
     --></a>
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;
            <script type="text/javascript">
                var fd = new Date();
                document.write(fd.getFullYear());
            </script>
            &nbsp;小世界，大梦想
          <div>
		<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
		<div>
		本站总访问量 <span id="busuanzi_value_site_pv"></span> &nbsp&nbsp&nbsp
		你是第<span id="busuanzi_value_site_uv"></span>个来到的小伙伴
		</div>
	</div>
        </div>

        <!-- Paradox Footer Right Section -->
        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
         

	</div>
    
</footer>


                    <!-- Import File -->
<script src="/js/highlight.min.js"></script>
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();

    $('#nprogress .bar').css({
        'background': '#FF4081'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #FF4081, 0 0 15px #FF4081'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#FF4081',
        'border-left-color': '#FF4081'
    });

    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>





    <!-- Leancloud -->
    <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
    <script>
        AV.initialize("f8AHUn2FOKCWoFzJTLrnSt4A-gzGzoHsz", "dOlRTKgDWf3Ut87VDHex4Wks");
    </script>
    <script>
    function showTime(Counter) {
        var query = new AV.Query(Counter);
        $('.leancloud-views_num').each(function() {
            var url = $(this).attr('id').trim();
            query.equalTo('url', url);
            query.find({
                success: function(results) {
                    if (results.length === 0) {
                        var content = '0 ' + $(document.getElementById(url)).text();
                        $(document.getElementById(url)).text(content);
                        return;
                    }
                    for (var i = 0; i < results.length; i++) {
                        var object = results[i];
                        var content = object.get('time') + ' ' + $(document.getElementById(url)).text();
                        $(document.getElementById(url)).text(content);
                    }
                },
                error: function(object, error) {
                    console.log('Error: ' + error.code + ' ' + error.message);
                }
            });
        });
    }

    function addCount(Counter) {
      var Counter = AV.Object.extend('Counter');
      url = $('.leancloud-views_num').attr('id').trim();
      title = $('.leancloud-views_num').attr('data-flag-title').trim();
      var query = new AV.Query(Counter);
      query.equalTo('url', url);
      query.find({
          success: function(results) {
            if (results.length > 0) {
                var counter = results[0];
                counter.fetchWhenSave(true);
                counter.increment('time');
                counter.save(null, {
                    success: function(counter) {
                        var content =  counter.get('time') + ' ' + $(document.getElementById(url)).text();
                        $(document.getElementById(url)).text(content);
                    },
                    error: function(counter, error) {
                        console.log('Failed to save Visitor num, with error message: ' + error.message);
                    }
                });
            } else {
              var newcounter = new Counter();
              newcounter.set('title', title);
              newcounter.set('url', url);
              newcounter.set('time', 1);
              newcounter.save(null, {
                  success: function(newcounter) {
                      console.log('newcounter.get(\'time\')='+newcounter.get('time'));
                      var content = newcounter.get('time') + ' ' + $(document.getElementById(url)).text();
                      $(document.getElementById(url)).text(content);
                  },
                  error: function(newcounter, error) {
                      console.log('Failed to create');
                  }
              });
            }
        },
        error: function(error) {
            console.log('Error:' + error.code + ' ' + error.message);
        }
      });
    }
    $(function() {
        var Counter = AV.Object.extend('Counter');
        if ($('.leancloud-views_num').length === 1) {
            addCount(Counter);
        } else if ($('.post-title-link').length > 1) {
            showTime(Counter);
        }
    });
</script>






    <!-- 多说公共 js 代码 start -->
    <script type="text/javascript">
        var duoshuoQuery = {
            short_name: 'stanxia'
        };
        (function() {
            var ds = document.createElement('script');
            ds.type = 'text/javascript';
            ds.async = true;
            ds.src = 'https://static.duoshuo.com/embed.js';
            ds.charset = 'UTF-8';
            (document.getElementsByTagName('head')[0]
             || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
    </script>
    <!-- 多说公共 js 代码 end -->





<!-- Swiftye -->


<!-- Local Search-->

    <script>
    var searchFunc = function(path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: 'xml',
            success: function( xmlResponse ) {
                // get the contents from search data
                var datas = $( 'entry', xmlResponse ).map(function() {
                    return {
                        title: $( 'title', this ).text(),
                        content: $('content',this).text(),
                        url: $( 'url' , this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function() {
                    var str='<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function(data) {
                        var isMatch = true;
                        var content_index = [];
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                        var data_url = data.url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if(data_title != '' && data_content != '') {
                            keywords.forEach(function(keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if( index_title < 0 && index_content < 0 ) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += '<li><a href="'+ data_url +'" class="search-result-title" target="_blank">'+ data_title;
                            var content = data.content.trim().replace(/<[^>]+>/g, '');
                            if (first_occur >= 0) {
                                // cut out characters
                                var start = first_occur - 6;
                                var end = first_occur + 6;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 10;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function(keyword) {
                                    var regS = new RegExp(keyword, 'gi');
                                    match_content = match_content.replace(regS, '<em class="search-keyword">'+keyword+'</em>');
                                })
                                str += '<p class="search-result">' + match_content +'...</p>' +'</a>';
                            }
                        }
                    });
                    $resultContent.innerHTML = str;
                });
            }
        });
    }
</script>


    <script>
        var inputArea = document.querySelector('#search');
        var getSearchFile = function() {
            var path = 'search.xml';
            searchFunc(path, 'search', 'local-search-result');
        }

        if(inputArea) {
            inputArea.onfocus = function() {
                getSearchFile();
            }
        }
    </script>


<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->


                </main>
            </div>
        </body>
    
</html>
